/*
    *
    * Wijmo Library 5.20152.84
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    * 
    * Licensed under the Wijmo Commercial License. 
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},wijmo;wijmo.culture.FlexGrid={groupHeaderFormat:"{name}: <b>{value} <\/b>({count:n0} items)"},function(n){(function(t){"use strict";(function(n){n[n.None=0]="None";n[n.Column=1]="Column";n[n.Row=2]="Row";n[n.All=3]="All"})(t.HeadersVisibility||(t.HeadersVisibility={}));var i=t.HeadersVisibility,r=function(r){function u(i,u){r.call(this,i,null,!0);this._szClient=new n.Size(0,0);this._ptScrl=new n.Point(0,0);this._rtl=!1;this._autoGenCols=!0;this._autoClipboard=!0;this._readOnly=!1;this._indent=14;this._autoSizeMode=t.AutoSizeMode.Both;this._hdrVis=3;this._alSorting=!0;this._alAddNew=!1;this._alDelete=!1;this._alResizing=1;this._alDragging=1;this._alMerging=0;this._ssHdr=0;this._shSort=!0;this._shGroups=!0;this._deferResizing=!1;this.itemsSourceChanged=new n.Event;this.scrollPositionChanged=new n.Event;this.selectionChanging=new n.Event;this.selectionChanged=new n.Event;this.loadingRows=new n.Event;this.loadedRows=new n.Event;this.resizingColumn=new n.Event;this.resizedColumn=new n.Event;this.autoSizingColumn=new n.Event;this.autoSizedColumn=new n.Event;this.draggingColumn=new n.Event;this.draggedColumn=new n.Event;this.resizingRow=new n.Event;this.resizedRow=new n.Event;this.autoSizingRow=new n.Event;this.autoSizedRow=new n.Event;this.draggingRow=new n.Event;this.draggedRow=new n.Event;this.groupCollapsedChanging=new n.Event;this.groupCollapsedChanged=new n.Event;this.sortingColumn=new n.Event;this.sortedColumn=new n.Event;this.beginningEdit=new n.Event;this.prepareCellForEdit=new n.Event;this.cellEditEnding=new n.Event;this.cellEditEnded=new n.Event;this.rowEditEnding=new n.Event;this.rowEditEnded=new n.Event;this.rowAdded=new n.Event;this.deletingRow=new n.Event;this.copying=new n.Event;this.copied=new n.Event;this.pasting=new n.Event;this.pasted=new n.Event;this.formatItem=new n.Event;this._mappedColumns=null;var o=this.hostElement,f=this,s=getComputedStyle(o),h=getComputedStyle(document.body),e=parseInt(s.fontSize&&n.contains(document.body,o)?s.fontSize:h.fontSize)*2;(e<=0||isNaN(e))&&(e=28);navigator.userAgent.match(/MSIE |Trident\/|Edge\//)&&(o.style.borderRadius="0px");this.deferUpdate(function(){f._rows=new t.RowCollection(f,e);f._cols=new t.ColumnCollection(f,e*4);f._hdrRows=new t.RowCollection(f,e);f._hdrCols=new t.ColumnCollection(f,Math.round(e*1.25));f._hdrRows.push(new t.Row);f._hdrCols.push(new t.Column);f._hdrCols[0].align="center";f._createChildren();f._cf=new t.CellFactory;f._keyHdl=new t._KeyboardHandler(f);f._mouseHdl=new t._MouseHandler(f);f._edtHdl=new t._EditHandler(f);f._selHdl=new t._SelectionHandler(f);f._addHdl=new t._AddNewHandler(f);f._mrgMgr=new t.MergeManager(f);f._bndSortConverter=f._sortConverter.bind(f);f.initialize(u)});this.addEventListener(this._root,"scroll",function(){f._raf&&cancelAnimationFrame(f._raf);f._raf=requestAnimationFrame(function(){f.finishEditing();f._updateScrollPosition()&&f._updateContent(!0);f._raf=null})})}return __extends(u,r),u.prototype._handleResize=function(){r.prototype._handleResize.call(this);this._rcBounds=null},Object.defineProperty(u.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(t){t!=this._hdrVis&&(this._hdrVis=n.asEnum(t,i),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(t){this._autoGenCols=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(t){this._autoClipboard=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnLayout",{get:function(){for(var c,o,r,i,f,s=u._getSerializableProperties(t.Column),l=new t.Column,h=[],e=0;e<this.columns.length;e++){for(c=this.columns[e],o={},r=0;r<s.length;r++)i=s[r],f=c[i],f!=l[i]&&n.isPrimitive(f)&&i!="size"&&(o[i]=f);h.push(o)}return JSON.stringify({columns:h})},set:function(t){var i=JSON.parse(n.asString(t));if(!i||i.columns==null)throw"Invalid columnLayout data.";this.columns.clear();this.initialize(i)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){t!=this._readOnly&&(this._readOnly=n.asBoolean(t),this.finishEditing(),this.invalidate(!0),this._addHdl.updateNewRowTemplate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowResizing",{get:function(){return this._alResizing},set:function(i){this._alResizing=n.asEnum(i,t.AllowResizing)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"deferResizing",{get:function(){return this._deferResizing},set:function(t){this._deferResizing=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoSizeMode",{get:function(){return this._autoSizeMode},set:function(i){this._autoSizeMode=n.asEnum(i,t.AutoSizeMode)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(t){this._alSorting=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(t){t!=this._alAddNew&&(this._alAddNew=n.asBoolean(t),this._addHdl.updateNewRowTemplate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(t){t!=this._alDelete&&(this._alDelete=n.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(i){i!=this._alMerging&&(this._alMerging=n.asEnum(i,t.AllowMerging),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showSelectedHeaders",{get:function(){return this._ssHdr},set:function(t){t!=this._ssHdr&&(this._ssHdr=n.asEnum(t,i),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showMarquee",{get:function(){return!this._eMarquee.style.display},set:function(t){if(t!=this.showMarquee){var i=this._eMarquee.style;i.visibility="hidden";i.display=n.asBoolean(t)?"":"none";this.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showSort",{get:function(){return this._shSort},set:function(t){t!=this._shSort&&(this._shSort=n.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){t!=this._shGroups&&(this._shGroups=n.asBoolean(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(t){t!=this._gHdrFmt&&(this._gHdrFmt=n.asString(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowDragging",{get:function(){return this._alDragging},set:function(i){i!=this._alDragging&&(this._alDragging=n.asEnum(i,t.AllowDragging),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemsSource",{get:function(){return this._items},set:function(t){var i;this._items!=t&&(this._cv&&(i=n.tryCast(this._cv,n.collections.CollectionView),i&&i.sortConverter==this._bndSortConverter&&(i.sortConverter=null),this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this),this._cv=null),this._items=t,this._cv=n.asCollectionView(t),this._lastCount=0,this._cv!=null&&(this._cv.currentChanged.addHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this),i=n.tryCast(this._cv,n.collections.CollectionView),i&&i.sortConverter==null&&(i.sortConverter=this._bndSortConverter)),this._bindGrid(!0),this.onItemsSourceChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(n){n!=this._childItemsPath&&(this._childItemsPath=n,this._bindGrid(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"frozenRows",{get:function(){return this.rows.frozen},set:function(n){this.rows.frozen=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(n){this.columns.frozen=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"sortRowIndex",{get:function(){return this._sortRowIndex},set:function(t){t!=this._sortRowIndex&&(this._sortRowIndex=n.asNumber(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(n){var t=this._root,i=-n.x;if(this._rtl)switch(u._getRtlMode()){case"rev":i=t.scrollWidth-t.clientWidth+n.x;break;case"neg":i=n.x;break;default:i=-n.x}t.scrollLeft=i;t.scrollTop=-n.y},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"controlRect",{get:function(){return this._rcBounds||(this._rcBounds=n.getElementRect(this._root)),this._rcBounds},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"scrollSize",{get:function(){return new n.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cellFactory",{get:function(){return this._cf},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){t!=this._itemFormatter&&(this._itemFormatter=n.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),u.prototype.getCellData=function(n,t,i){return this.cells.getCellData(n,t,i)},u.prototype.getCellBoundingRect=function(n,t){return this.cells.getCellBoundingRect(n,t)},u.prototype.setCellData=function(n,t,i,r,u){return typeof r=="undefined"&&(r=!0),typeof u=="undefined"&&(u=!0),this.cells.setCellData(n,t,i,r,u)},u.prototype.hitTest=function(i,r){return n.isNumber(i)&&n.isNumber(r)&&(i=new n.Point(i,r)),new t.HitTestInfo(this,i)},u.prototype.getClipString=function(i){var r,u,o,f,e;for(i=i?n.asType(i,t.CellRange):this.selection,r="",u=i.topRow;u<=i.bottomRow;u++)if(this.rows[u].isVisible)for(o=!0,r&&(r+="\n"),f=i.leftCol;f<=i.rightCol;f++)this.columns[f].isVisible&&(o||(r+="\t"),o=!1,e=this.cells.getCellData(u,f,!0).toString(),e=e.replace(/\t/g," "),r+=e);return r},u.prototype.setClipString=function(i,r){var a=r==null,e,u,c,o,s,l,f,h;for(r=r?n.asType(r,t.CellRange):this.selection,i=n.asString(i).replace(/\r\n/g,"\n").replace(/\r/g,"\n"),i&&i[i.length-1]=="\n"&&(i=i.substring(0,i.length-1)),a&&!r.isSingleCell&&(i=this._expandClipString(i,r)),e=new t.CellRange(r.topRow,r.leftCol),this.beginUpdate(),u=r.topRow,c=i.split("\n"),s=0;s<c.length&&u<this.rows.length;s++,u++){if(!this.rows[u].isVisible){s--;continue}for(l=c[s].split("\t"),f=r.leftCol,h=0;h<l.length&&f<this.columns.length;h++,f++){if(!this.columns[f].isVisible){h--;continue}if(!this.columns[f].isReadOnly&&!this.rows[u].isReadOnly&&(o=new t.CellRangeEventArgs(this.cells,new t.CellRange(u,f)),this.onBeginningEdit(o)&&this.cells.setCellData(u,f,l[h]))){this.onCellEditEnding(o);this.onCellEditEnded(o);e.row2=Math.max(e.row2,u);e.col2=Math.max(e.col2,f)}this.onRowEditEnding(o);this.onRowEditEnded(o)}}this.endUpdate();this.collectionView&&this.collectionView.refresh();this.select(e)},u.prototype._expandClipString=function(n,t){var s,r,u,i,f;if(!n)return n;var h=n.split("\n"),o=h.length,e=0,c=[];for(i=0;i<o;i++){if(s=h[i].split("\t"),c.push(s),i>1&&s.length!=e)return n;e=s.length}if(r=t.rowSpan,u=t.columnSpan,(r>1||u>1)&&(r==1&&(r=o),u==1&&(u=e),u%e==0&&r%o==0))for(n="",i=0;i<r;i++)for(f=0;f<u;f++)i>0&&f==0&&(n+="\n"),f>0&&(n+="\t"),n+=c[i%o][f%e];return n},u.prototype.containsFocus=function(){var n=this._edtHdl._lbx;return r.prototype.containsFocus.call(this)||n&&n.containsFocus()},u.prototype.dispose=function(){this.finishEditing(!0);this.itemsSource=null;this._raf&&cancelAnimationFrame(this._raf);r.prototype.dispose.call(this)},u.prototype.refresh=function(n){typeof n=="undefined"&&(n=!0);r.prototype.refresh.call(this,n);this.finishEditing();n&&(this._updateColumnTypes(),this.scrollPosition=this._ptScrl);this.refreshCells(n)},u.prototype.refreshCells=function(n,t,i){this.isUpdating||(n?this._updateLayout():this._updateContent(t,i))},u.prototype.autoSizeColumn=function(n,t,i){typeof t=="undefined"&&(t=!1);typeof i=="undefined"&&(i=4);this.autoSizeColumns(n,n,t,i)},u.prototype.autoSizeColumns=function(t,i,r,u){typeof r=="undefined"&&(r=!1);typeof u=="undefined"&&(u=4);var o=this,e=0,h=r?this.topLeftCells:this.columnHeaders,f=r?this.rowHeaders:this.cells,s=this.viewRange,c,l;t=t==null?0:n.asInt(t);i=i==null?f.columns.length-1:n.asInt(i);n.asBoolean(r);n.asNumber(u);s.row=Math.max(0,s.row-1e3);s.row2=Math.min(s.row2+1e3,this.rows.length-1);this.deferUpdate(function(){var v=document.createElement("div"),a,n,y;for(v.style.visibility="hidden",o.hostElement.appendChild(v),a=t;a<=i&&a>-1&&a<f.columns.length;a++){if(e=0,o.autoSizeMode&1)for(n=0;n<h.rows.length;n++)h.rows[n].isVisible&&(y=o._getDesiredWidth(h,n,a,v),e=Math.max(e,y));if(o.autoSizeMode&2)for(l=null,n=s.row;n<=s.row2&&n>-1&&n<f.rows.length;n++)f.rows[n].isVisible&&(!r&&a==f.columns.firstVisibleIndex&&f.rows.maxGroupLevel>-1?(y=o._getDesiredWidth(f,n,a,v),e=Math.max(e,y)):(c=f.getCellData(n,a,!0),c!=l&&(l=c,y=o._getDesiredWidth(f,n,a,v),e=Math.max(e,y))));f.columns[a].width=e+u+2}o.hostElement.removeChild(v)})},u.prototype.autoSizeRow=function(n,t,i){typeof t=="undefined"&&(t=!1);typeof i=="undefined"&&(i=0);this.autoSizeRows(n,n,t,i)},u.prototype.autoSizeRows=function(t,i,r,u){typeof r=="undefined"&&(r=!1);typeof u=="undefined"&&(u=0);var f=this,e=0,s=r?this.topLeftCells:this.rowHeaders,o=r?this.columnHeaders:this.cells;r=n.asBoolean(r);u=n.asNumber(u);t=t==null?0:n.asInt(t);i=i==null?o.rows.length-1:n.asInt(i);this.deferUpdate(function(){var h=document.createElement("div"),r,n,c;for(h.style.visibility="hidden",f.hostElement.appendChild(h),r=t;r<=i&&r>-1&&r<o.rows.length;r++){if(e=0,f.autoSizeMode&1)for(n=0;n<s.columns.length;n++)s.columns[n].renderSize>0&&(c=f._getDesiredHeight(s,r,n,h),e=Math.max(e,c));if(f.autoSizeMode&2)for(n=0;n<o.columns.length;n++)o.columns[n].renderSize>0&&(c=f._getDesiredHeight(o,r,n,h),e=Math.max(e,c));o.rows[r].height=e+u}f.hostElement.removeChild(h)})},Object.defineProperty(u.prototype,"treeIndent",{get:function(){return this._indent},set:function(t){t!=this._indent&&(this._indent=n.asNumber(t,!1,!0),this.columns.onCollectionChanged())},enumerable:!0,configurable:!0}),u.prototype.collapseGroupsToLevel=function(i){if(this.finishEditing()){var r=this.rows;r.deferUpdate(function(){for(var f,u=0;u<r.length;u++)f=n.tryCast(r[u],t.GroupRow),f&&(f.isCollapsed=f.level>=i)})}},Object.defineProperty(u.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(i){i!=this.selectionMode&&(this._selHdl.selectionMode=n.asEnum(i,t.SelectionMode),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(n){this._selHdl.selection=n},enumerable:!0,configurable:!0}),u.prototype.select=function(i,r){typeof r=="undefined"&&(r=!0);n.isInt(i)&&n.isInt(r)&&(i=new t.CellRange(i,r),r=!0);i=n.asType(i,t.CellRange);this._selHdl.select(i,r)},u.prototype.getSelectedState=function(t,i){return this._selHdl.getSelectedState(n.asInt(t),n.asInt(i))},u.prototype.scrollIntoView=function(t,i){var u;this._maxOffsetY==null&&this._updateLayout();var r=this.scrollPosition,h=this._szClient.width,e=this._szClient.height,o=this.cells._getFrozenPos();if(t=n.asInt(t),t>-1&&t<this._rows.length&&t>=this._rows.frozen){var f=this._rows[t],c=this.cells.height>e?Math.round(f.pos/(this.cells.height-e)*100)/100:0,l=Math.round(this._maxOffsetY*c),s=f.pos-l;f.pos+f.renderSize>-r.y+e&&(r.y=Math.max(-s,e-(f.pos+f.renderSize)));s-o.y<-r.y&&(r.y=-(s-o.y))}return(i=n.asInt(i),i>-1&&i<this._cols.length&&i>=this._cols.frozen&&(u=this._cols[i],u.pos+u.renderSize>-r.x+h&&(r.x=Math.max(-u.pos,h-(u.pos+u.renderSize))),u.pos-o.x<-r.x&&(r.x=-(u.pos-o.x))),!r.equals(this.scrollPosition))?(this.scrollPosition=r,!0):!1},u.prototype.isRangeValid=function(n){return n.isValid&&n.bottomRow<this.rows.length&&n.rightCol<this.columns.length},u.prototype.startEditing=function(n,t,i){return typeof n=="undefined"&&(n=!0),this._edtHdl.startEditing(n,t,i)},u.prototype.finishEditing=function(n){return typeof n=="undefined"&&(n=!1),this._edtHdl.finishEditing(n)},Object.defineProperty(u.prototype,"activeEditor",{get:function(){return this._edtHdl.activeEditor},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"editRange",{get:function(){return this._edtHdl.editRange},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(t){t!=this._mrgMgr&&(this._mrgMgr=n.asType(t,"IMergeManager",!0),this.invalidate())},enumerable:!0,configurable:!0}),u.prototype.getMergedRange=function(n,t,i,r){return typeof r=="undefined"&&(r=!0),this._mrgMgr?this._mrgMgr.getMergedRange(n,t,i,r):null},u.prototype.onItemsSourceChanged=function(){this.itemsSourceChanged.raise(this)},u.prototype.onScrollPositionChanged=function(){this.scrollPositionChanged.raise(this)},u.prototype.onSelectionChanging=function(n){return this.selectionChanging.raise(this,n),!n.cancel},u.prototype.onSelectionChanged=function(n){return this.selectionChanged.raise(this,n),!n.cancel},u.prototype.onLoadingRows=function(n){return this.loadingRows.raise(this,n),!n.cancel},u.prototype.onLoadedRows=function(n){this.loadedRows.raise(this,n)},u.prototype.onResizingColumn=function(n){return this.resizingColumn.raise(this,n),!n.cancel},u.prototype.onResizedColumn=function(n){this.resizedColumn.raise(this,n)},u.prototype.onAutoSizingColumn=function(n){return this.autoSizingColumn.raise(this,n),!n.cancel},u.prototype.onAutoSizedColumn=function(n){this.autoSizedColumn.raise(this,n)},u.prototype.onDraggingColumn=function(n){return this.draggingColumn.raise(this,n),!n.cancel},u.prototype.onDraggedColumn=function(n){this.draggedColumn.raise(this,n)},u.prototype.onResizingRow=function(n){return this.resizingRow.raise(this,n),!n.cancel},u.prototype.onResizedRow=function(n){this.resizedRow.raise(this,n)},u.prototype.onAutoSizingRow=function(n){return this.autoSizingRow.raise(this,n),!n.cancel},u.prototype.onAutoSizedRow=function(n){this.autoSizedRow.raise(this,n)},u.prototype.onDraggingRow=function(n){return this.draggingRow.raise(this,n),!n.cancel},u.prototype.onDraggedRow=function(n){this.draggedRow.raise(this,n)},u.prototype.onGroupCollapsedChanging=function(n){return this.groupCollapsedChanging.raise(this,n),!n.cancel},u.prototype.onGroupCollapsedChanged=function(n){this.groupCollapsedChanged.raise(this,n)},u.prototype.onSortingColumn=function(n){return this.sortingColumn.raise(this,n),!n.cancel},u.prototype.onSortedColumn=function(n){this.sortedColumn.raise(this,n)},u.prototype.onBeginningEdit=function(n){return this.beginningEdit.raise(this,n),!n.cancel},u.prototype.onPrepareCellForEdit=function(n){this.prepareCellForEdit.raise(this,n)},u.prototype.onCellEditEnding=function(n){return this.cellEditEnding.raise(this,n),!n.cancel},u.prototype.onCellEditEnded=function(n){this.cellEditEnded.raise(this,n)},u.prototype.onRowEditEnding=function(n){this.rowEditEnding.raise(this,n)},u.prototype.onRowEditEnded=function(n){this.rowEditEnded.raise(this,n)},u.prototype.onRowAdded=function(n){this.rowAdded.raise(this,n)},u.prototype.onDeletingRow=function(n){this.deletingRow.raise(this,n)},u.prototype.onCopying=function(n){return this.copying.raise(this,n),!n.cancel},u.prototype.onCopied=function(n){this.copied.raise(this,n)},u.prototype.onPasting=function(n){return this.pasting.raise(this,n),!n.cancel},u.prototype.onPasted=function(n){this.pasted.raise(this,n)},u.prototype.onFormatItem=function(n){this.formatItem.raise(this,n)},u.prototype._getDesiredWidth=function(n,t,i,r){var u=this.getMergedRange(n,t,i),f;return this.cellFactory.updateCell(n,t,i,r,u),r.style.width="",f=r.offsetWidth,u&&u.columnSpan>1?f/u.columnSpan:f},u.prototype._getDesiredHeight=function(n,t,i,r){var u=this.getMergedRange(n,t,i),f;return this.cellFactory.updateCell(n,t,i,r,u),r.style.height="",f=r.offsetHeight,u&&u.rowSpan>1?f/u.rowSpan:f},u.prototype._getSortRowIndex=function(){return this._sortRowIndex!=null?this._sortRowIndex:this.columnHeaders.rows.length-1},u.prototype._sortConverter=function(n,t,i,r){var u,e,f,o;if(r){if(this._mappedColumns=null,this.collectionView)for(e=this.collectionView.sortDescriptions,f=0;f<e.length;f++)u=this.columns.getColumn(e[f].property),u&&u.dataMap&&(this._mappedColumns||(this._mappedColumns={}),this._mappedColumns[u.binding]=u.dataMap);this._mouseHdl._htDown&&this._mouseHdl._htDown.col>-1&&(u=this.columns[this._mouseHdl._htDown.col],this._mappedColumns&&u.dataMap&&(this._mappedColumns[u.binding]=u.dataMap))}return this._mappedColumns&&(o=this._mappedColumns[n.property],o&&(i=o.getDisplayValue(i))),i},u.prototype._bindGrid=function(t){var i=this,r;i.deferUpdate(function(){var u,f,e,n;if(i._lastCount==0&&i._cv&&i._cv.items&&i._cv.items.length&&(t=!0),u=[],i.selectionMode==5)for(n=0;n<i.rows.length;n++)f=i.rows[n],f.isSelected&&f.dataItem&&u.push(f.dataItem);if(i.rows.deferUpdate(function(){i._bindRows()}),t&&i.columns.deferUpdate(function(){i._bindColumns()}),e=0,u.length)for(n=0;n<i.rows.length&&e<u.length;n++)u.indexOf(i.rows[n].dataItem)>-1&&(i.rows[n].isSelected=!0,e++);if(i.selectionMode==5&&e==0)for(r=i.selection,n=r.topRow;n<=r.bottomRow&&n>-1&&n<i.rows.length;n++)i.rows[n].isSelected=!0;!i._lastCount&&i._cv&&i._cv.items&&(i._lastCount=i._cv.items.length)});i.collectionView&&i._cvCurrentChanged(i.collectionView,n.EventArgs.empty)},u.prototype._cvCollectionChanged=function(i,r){var u;if(this.autoGenerateColumns&&this.columns.length==0)this._bindGrid(!0);else{switch(r.action){case 2:this.invalidate();return;case 0:if(r.index==this.collectionView.items.length-1){u=this.rows.length;this.rows[u-1]instanceof t._NewRowTemplate&&u--;this.rows.insert(u,new t.Row(r.item));return}n.assert(!1,"added item should be the last one.");break;case 1:if(u=this._findRow(r.item),u>-1){this.rows.removeAt(u);this._cvCurrentChanged(i,r);return}n.assert(!1,"removed item not found in grid.")}this._bindGrid(!1)}},u.prototype._cvCurrentChanged=function(){if(this.collectionView){var n=this.selection,t=this._getRowIndex(this.collectionView.currentPosition);n.row!=t&&(n.row=n.row2=t,this.select(n,!1),this.scrollIntoView(n.row,-1))}},u.prototype._getRowIndex=function(n){var r,n,i;if(this.collectionView){if(n>-1){for(r=this.collectionView.items[n];n<this.rows.length;n++)if(this.rows[n].dataItem===r)return n;return-1}return this.rows.length==1&&this.rows[0]instanceof t._NewRowTemplate?0:(n=this.selection.row,i=n>-1?this.rows[n]:null,i&&(i instanceof t.GroupRow||i.dataItem==null)?n:-1)}return this.selection.row},u.prototype._getCvIndex=function(n){if(n>-1&&this.collectionView){var t=this.rows[n].dataItem;for(n=Math.min(n,this.collectionView.items.length);n>-1;n--)if(this.collectionView.items[n]===t)return n}return-1},u.prototype._findRow=function(n){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==n)return t;return-1},u.prototype._createChildren=function(){var n=this.getTemplate();this.applyTemplate("wj-control wj-flexgrid wj-content",n,{_root:"root",_eSz:"sz",_eCt:"cells",_eTL:"tl",_eCHdr:"ch",_eRHdr:"rh",_eTLCt:"tlcells",_eCHdrCt:"chcells",_eRHdrCt:"rhcells",_eMarquee:"marquee"});this._gpCells=new t.GridPanel(this,1,this._rows,this._cols,this._eCt);this._gpCHdr=new t.GridPanel(this,2,this._hdrRows,this._cols,this._eCHdrCt);this._gpRHdr=new t.GridPanel(this,3,this._rows,this._hdrCols,this._eRHdrCt);this._gpTL=new t.GridPanel(this,4,this._hdrRows,this._hdrCols,this._eTLCt)},u.prototype._updateLayout=function(){var r=this._rows.getTotalSize(),t=this._hdrVis&2?this._hdrCols.getTotalSize():0,i=this._hdrVis&1?this._hdrRows.getTotalSize():0,f,e,o;r<1&&(r=1);this._rtl=this.hostElement?getComputedStyle(this.hostElement).direction=="rtl":!1;this._heightBrowser=Math.min(r,u._getMaxSupportedCssHeight());this._maxOffsetY=Math.max(0,r-this._heightBrowser);this._rtl?(n.setCss(this._eTL,{right:0,top:0,width:t,height:i}),n.setCss(this._eCHdr,{top:0,right:t,height:i}),n.setCss(this._eRHdr,{right:0,top:i,width:t}),n.setCss(this._eCt,{right:t,top:i,width:this._gpCells.width,height:this._heightBrowser})):(n.setCss(this._eTL,{left:0,top:0,width:t,height:i}),n.setCss(this._eCHdr,{top:0,left:t,height:i}),n.setCss(this._eRHdr,{left:0,top:i,width:t}),n.setCss(this._eCt,{left:t,top:i,width:this._gpCells.width,height:this._heightBrowser}));f=this._root.offsetWidth-this._root.clientWidth;e=this._root.offsetHeight-this._root.clientHeight;n.setCss(this._eSz,{width:t+f+this._gpCells.width,height:i+e+this._heightBrowser});o=null;this.columns._updateStarSizes(this._root.clientWidth-t)&&(o=this._root.clientWidth,this._eCt.style.width=this._gpCells.width+"px");this._szClient=new n.Size(this._root.clientWidth-t,this._root.clientHeight-i);this._rcBounds=null;this._updateContent(!1);f=this._root.offsetWidth-this._root.clientWidth;e=this._root.offsetHeight-this._root.clientHeight;n.setCss(this._eSz,{width:t+f+this._gpCells.width,height:i+e+this._heightBrowser});this._szClient=new n.Size(this._root.clientWidth-t,this._root.clientHeight-i);o&&o!=this._root.clientWidth&&this.columns._updateStarSizes(this._root.clientWidth-t)&&(this._eCt.style.width=this._gpCells.width+"px",this._updateContent(!1));this._eCHdr.style.width=this._szClient.width+"px";this._eRHdr.style.height=this._szClient.height+"px"},u.prototype._updateScrollPosition=function(){var t=this._root,f=t.scrollTop,i=t.scrollLeft,r;return(this._rtl&&u._getRtlMode()=="rev"&&(i=t.scrollWidth-t.clientWidth-i),r=new n.Point(-Math.abs(i),-f),this._ptScrl.equals(r))?!1:(this._ptScrl=r,this.onScrollPositionChanged(),!0)},u.prototype._updateContent=function(t,i){var f=this,l=this.containsFocus(),a=n.contains(this.columnHeaders.hostElement,document.activeElement),o=1,e,r;if(this._heightBrowser>this._szClient.height&&(o=Math.round(-this._ptScrl.y/(this._heightBrowser-this._szClient.height)*100)/100),this._offsetY=Math.round(this._maxOffsetY*o),this._gpCells._updateContent(t,i,this._offsetY),this._hdrVis&1&&(!i||this._ssHdr&1)&&this._gpCHdr._updateContent(t,i,0),this._hdrVis&2&&(!i||this._ssHdr&2)&&this._gpRHdr._updateContent(t,i,this._offsetY),this._hdrVis&&!i&&this._gpTL._updateContent(t,i,0),this.showMarquee)if(e=this._selHdl._sel,r=this._eMarquee,e.isValid&&this.rows.length&&this.columns.length){var u=this._getMarqueeRect(e),s=r.firstChild,h=r.offsetWidth-s.offsetWidth,c=r.offsetHeight-s.offsetHeight;n.setCss(r,{left:u.left+this.cells.hostElement.offsetLeft-h/2,top:u.top+this.cells.hostElement.offsetTop-c/2,width:u.width+h,height:u.height+c,visibility:u.width>0&&u.height>0?"":"hidden"})}else r.style.visibility="hidden";l&&!i&&setTimeout(function(){f.containsFocus()||(a?f.columnHeaders.hostElement.focus():f.focus())},10);this._rcBounds=null},u.prototype._getMarqueeRect=function(i){var s=this.getMergedRange(this.cells,i.topRow,i.leftCol)||new t.CellRange(i.topRow,i.leftCol),h=this.getMergedRange(this.cells,i.bottomRow,i.rightCol)||new t.CellRange(i.bottomRow,i.rightCol),u=this.cells.getCellBoundingRect(s.topRow,s.leftCol,!0),f=this.cells.getCellBoundingRect(h.bottomRow,h.rightCol,!0),e,o,r;return this.rows.frozen&&(e=Math.min(this.rows.length,this.rows.frozen),r=this.cells.getCellBoundingRect(e-1,0,!0),i.topRow>=e&&u.top<r.bottom&&(u.top=r.bottom),i.bottomRow>=e&&f.bottom<r.bottom&&(f.height=r.bottom-f.top)),this.columns.frozen&&(o=Math.min(this.columns.length,this.columns.frozen),r=this.cells.getCellBoundingRect(0,o-1,!0),i.leftCol>=o&&u.left<r.right&&(u.left=r.right),i.rightCol>=o&&f.right<r.right&&(f.width=r.right-f.left)),new n.Rect(u.left,u.top,f.right-u.left,f.bottom-u.top)},u.prototype._bindColumns=function(){for(var i,r,f,e,o,u=0;u<this.columns.length;u++)i=this.columns[u],i._getFlag(32)&&(this.columns.removeAt(u),u--);if(r=null,f=this.collectionView,f&&f.sourceCollection&&f.sourceCollection.length&&(r=f.sourceCollection[0]),r&&this.autoGenerateColumns)for(e in r)n.isPrimitive(r[e])&&(i=new t.Column,i._setFlag(32,!0),i.binding=i.name=e,i.dataType=n.getType(r[e]),o=Object.getOwnPropertyDescriptor(r,e),o&&!o.writable&&i._setFlag(512,!0),i.dataType==2&&(i.width=80),this.columns.push(i));r&&this._updateColumnTypes()},u.prototype._updateColumnTypes=function(){var i=this.collectionView,u,t,r;if(i&&i.items&&i.items.length)for(u=i.items[0],r=0;r<this.columns.length;r++)t=this.columns[r],t.dataType==null&&t._binding&&(t.dataType=n.getType(t._binding.getValue(u)))},u.prototype._bindRows=function(){var f=new n.CancelEventArgs,r,u,i;this.onLoadingRows(f);if(!f.cancel){if(this.rows.clear(),this.collectionView&&this.collectionView.items)if(r=this.collectionView.items,u=this.collectionView.groups,this.childItemsPath)for(i=0;i<r.length;i++)this._addTreeNode(r[i],0);else if(u!=null&&u.length>0&&this.showGroups)for(i=0;i<u.length;i++)this._addGroup(u[i]);else for(i=0;i<r.length;i++)this.rows.push(new t.Row(r[i]));this.onLoadedRows(f)}},u.prototype._addGroup=function(n){var r=new t.GroupRow,u,i;if(r.level=n.level,r.dataItem=n,this.rows.push(r),n.isBottomLevel)for(i=0;i<n.items.length;i++)u=new t.Row(n.items[i]),this.rows.push(u);else for(i=0;i<n.groups.length;i++)this._addGroup(n.groups[i])},u.prototype._addTreeNode=function(n,i){var u=new t.GroupRow,f=n[this.childItemsPath],r;if(u.dataItem=n,u.level=i,this.rows.push(u),f)for(r=0;r<f.length;r++)this._addTreeNode(f[r],i+1)},u._getSerializableProperties=function(n){var f=[],u,t,i,r;for(n=n.prototype;n;n=Object.getPrototypeOf(n))for(u=Object.getOwnPropertyNames(n),t=0;t<u.length;t++)i=u[t],r=Object.getOwnPropertyDescriptor(n,i),r&&r.set&&r.get&&i[0]!="_"&&f.push(i);return f},u.prototype._copy=function(i,r){var f,u,e;if(i=="columns"){for(f=n.asArray(r),u=0;u<f.length;u++)e=new t.Column,n.copy(e,f[u]),this.columns.push(e);return!0}return!1},u._getMaxSupportedCssHeight=function(){var n;if(!u._maxCssHeight){var i=1e6,t=document.createElement("div");for(t.style.visibility="hidden",document.body.appendChild(t),n=i;n<=6e7;n+=5e5){if(t.style.height=n+"px",t.offsetHeight!=n)break;i=n}document.body.removeChild(t);u._maxCssHeight=i}return u._maxCssHeight},u._getRtlMode=function(){var t,i,r;return u._rtlMode||(t=n.createElement('<div dir="rtl" style="visibility:hidden;width:100px;height:100px;overflow:auto"><div style="width:2000px;height:2000px"><\/div><\/div>'),document.body.appendChild(t),i=t.scrollLeft,t.scrollLeft=-1e3,r=t.scrollLeft,document.body.removeChild(t),u._rtlMode=r<0?"neg":i>0?"rev":"std"),u._rtlMode},u.controlTemplate='<div style="position:relative;width:100%;height:100%;max-height:inherit;overflow:hidden"><div wj-part="root" style="position:absolute;width:100%;height:100%;max-height:inherit;overflow:auto;-webkit-overflow-scrolling:touch"><div wj-part="cells" style ="position:relative"><\/div><div wj-part="marquee" class="wj-marquee" style="display:none;pointer-events:none"><div style="width:100%;height:100%"><\/div><\/div><\/div><div wj-part="tl" style="position:absolute;overflow:hidden"><div wj-part="tlcells" class="wj-topleft" style="position:relative"><\/div><\/div><div wj-part="ch" style="position:absolute;overflow:hidden"><div wj-part="chcells" class="wj-colheaders" style="position:relative"><\/div><\/div><div wj-part="rh" style="position:absolute;overflow:hidden"><div wj-part="rhcells" class="wj-rowheaders" style="position:relative"><\/div><\/div><div wj-part="sz" style="position:relative;visibility:hidden;"><\/div><\/div>',u}(n.Control);t.FlexGrid=r})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";var i=function(i){function r(r,u){i.call(this);this._panel=n.asType(r,t.GridPanel);this._rng=n.asType(u,t.CellRange)}return __extends(r,i),Object.defineProperty(r.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cellRange",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0}),r}(n.CancelEventArgs),r;t.CellRangeEventArgs=i;r=function(t){function i(i,r,u){t.call(this,i,r);this._cell=n.asType(u,HTMLElement)}return __extends(i,t),Object.defineProperty(i.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),i}(i);t.FormatItemEventArgs=r})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";(function(n){n[n.None=0]="None";n[n.Cell=1]="Cell";n[n.ColumnHeader=2]="ColumnHeader";n[n.RowHeader=3]="RowHeader";n[n.TopLeft=4]="TopLeft"})(t.CellType||(t.CellType={}));var r=t.CellType,i=function(){function i(i,r,u,f,e){this._offsetY=0;this._g=n.asType(i,t.FlexGrid);this._ct=n.asInt(r);this._rows=n.asType(u,t.RowCollection);this._cols=n.asType(f,t.ColumnCollection);this._e=n.asType(e,HTMLElement);this._rng=new t.CellRange}return Object.defineProperty(i.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewRange",{get:function(){return this._getViewRange(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),i.prototype.getCellData=function(i,r,u){var f=this._cols[r],o=this._rows[i],e=null,s;if(!f.binding||!o.dataItem||o.dataItem instanceof n.collections.CollectionViewGroup?o._ubv&&(e=o._ubv[f._hash]):e=f._binding.getValue(o.dataItem),e==null)switch(this._ct){case 2:i==this._rows.length-1&&f.header&&(e=f.header);break;case 1:f.aggregate!=0&&o instanceof t.GroupRow&&(s=n.tryCast(o.dataItem,n.collections.CollectionViewGroup),s&&(e=s.getAggregate(f.aggregate,f.binding,this._g.collectionView)))}return u&&(this.cellType==1&&f.dataMap&&(e=f.dataMap.getDisplayValue(e)),e=e!=null?n.Globalize.format(e,f.format):""),e},i.prototype.setCellData=function(t,i,r,u,f){var o,e,s,h;if(typeof u=="undefined"&&(u=!0),typeof f=="undefined"&&(f=!0),o=this._rows[n.asNumber(t,!1,!0)],n.isString(i)&&(i=this._cols.indexOf(i),i<0))throw"Invalid column name or binding.";if(e=this._cols[n.asNumber(i,!1,!0)],this._ct==1){if(e.dataMap&&r!=null&&(e.required||r!=""&&r!=null)&&(r=e.dataMap.getKeyValue(r),r==null))return!1;if(s=0,e.dataType?s=e.dataType:(h=this.getCellData(t,i,!1),s=n.getType(h)),n.isBoolean(e.required))if(e.required||r!==""&&r!==null){if(e.required&&(r===""||r===null))return!1}else r=null,u=!1;if(u&&(r=n.changeType(r,s,e.format),s!=0&&n.getType(r)!=s))return!1}return o.dataItem&&e.binding?e._binding.setValue(o.dataItem,r):(o._ubv||(o._ubv={}),o._ubv[e._hash]=r),f&&this._g&&this._g.invalidate(),!0},i.prototype.getCellBoundingRect=function(t,i,r){var e=this.rows[t],o=this.columns[i],u=new n.Rect(o.pos,e.pos,o.renderSize,e.renderSize),f;return this._g._rtl&&(u.left=this.hostElement.offsetWidth-u.right),r||(f=this.hostElement.getBoundingClientRect(),u.left+=f.left,u.top+=f.top-this._offsetY),t<this.rows.frozen&&(u.top-=this._g.scrollPosition.y),i<this.columns.frozen&&(u.left-=this._g.scrollPosition.x),u},i.prototype.getSelectedState=function(n,t,i){var r=this._g,u=r._selHdl._sel;if(r.selectionMode!=0)switch(this._ct){case 1:return r.getSelectedState(n,t);case 2:if(r.showSelectedHeaders&1&&(r.columns[t].isSelected||u.containsColumn(t))&&(i&&(n=i.bottomRow),n==this.rows.length-1))return 1;break;case 3:if(r.showSelectedHeaders&2&&(r.rows[n].isSelected||u.containsRow(n))&&(i&&(n=i.rightCol),t==this.columns.length-1))return 1}return 0},Object.defineProperty(i.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),i.prototype._getOffsetY=function(){return this._offsetY},i.prototype._updateContent=function(t,i,r){var u,e,v,l=this._g,o=this._rows,y=this._cols,s,h,a,f,p,c;if((this._ct==2||this._ct==3)&&(s=l._ptScrl,h=this._e.style,this.cellType==2?l._rtl?h.right=s.x+"px":h.left=s.x+"px":this.cellType==3&&(h.top=s.y+"px")),this._offsetY!=r&&(t=!1,this._offsetY=r),a=this._getViewRange(!1),f=t&&l.isTouching?this._getViewRange(!0):a,!t||i||o.frozen||y.frozen||!this._rng.contains(a)){for(t&&f.equals(this._rng)||(i=!1),t||n.setText(this._e,null),!t||this._ct!=1||o.frozen||y.frozen||this._reorderCells(f,this._rng),this._rng=f,e=0,u=f.topRow;u<=f.bottomRow&&u>-1;u++)e=this._renderRow(u,f,!1,i,e);for(u=f.topRow;u<=f.bottomRow&&u>-1;u++)e=this._renderRow(u,f,!0,i,e);for(u=0;u<o.frozen&&u<o.length;u++)e=this._renderRow(u,f,!1,i,e);for(u=0;u<o.frozen&&u<o.length;u++)e=this._renderRow(u,f,!0,i,e);for(p=this._e.childElementCount,c=e;c<p;c++)v=this._e.children[c],v.style.display="none"}},i.prototype._reorderCells=function(n,t){var h=Math.max(1,n.rowSpan-1),r=n.row>-1&&t.row>-1&&n.intersects(t)?n.row-t.row:0,i,f,e;if(r>0&&r<=h){for(var s=this._g.rows[n.row],c=s.pos,u=0;u<this._e.childElementCount;u++)if(f=this._e.children[u],e=parseInt(f.style.top),e>=c)break;i=document.createRange();i.setStart(this._e,0);i.setEnd(this._e,u);this._e.appendChild(i.extractContents())}if(r<0&&r>=-h){for(var s=this._g.rows[n.row2],l=s.pos+s.renderSize,o=this._e.childElementCount-1;o>=0;o--)if(f=this._e.children[o],e=parseInt(f.style.top),e<l)break;i=document.createRange();i.setStart(this._e,o+1);i.setEnd(this._e,this._e.childElementCount);this._e.insertBefore(i.extractContents(),this._e.firstChild)}},i.prototype._renderRow=function(n,t,i,r,u){var f;if(this.rows[n].renderSize<=0)return u;if(i)for(f=0;f<this.columns.frozen&&f<this.columns.length;f++)u=this._renderCell(n,f,t,r,u);else for(f=t.leftCol;f<=t.rightCol&&f>-1;f++)u=this._renderCell(n,f,t,r,u);return u},i.prototype._renderCell=function(t,i,r,u,f){var o=this._g.getMergedRange(this,t,i),e,s;return o&&(t>r.topRow&&o.row<t||i>r.leftCol&&o.col<i)?f:this.columns[i].renderSize<=0&&(!o||o.getRenderSize(this).width<=0)?f:(e=this._e.childNodes[f++],e&&u)?(s=this.getSelectedState(t,i,o),n.toggleClass(e,"wj-state-selected",s==2),n.toggleClass(e,"wj-state-multi-selected",s==1),f):(e||(e=document.createElement("div"),e.tabIndex=0,this._e.appendChild(e)),this._g.cellFactory.updateCell(this,t,i,e,o),f)},i.prototype._getViewRange=function(n){var s=this._g,l=s._ptScrl,r=this._rows,u=this._cols,i=new t.CellRange(0,0,r.length-1,u.length-1),f,e;if(this._ct==1||this._ct==3){var h=-l.y+this._offsetY,a=s.clientSize.height+1,o=Math.min(r.frozen,r.length-1);o>0&&(f=r[o-1].pos,h+=f,a-=f);i.row=Math.min(r.length-1,Math.max(r.frozen,r.getItemAt(h)));i.row2=r.getItemAt(h+a)}if(this._ct==1||this._ct==2){var c=-l.x,v=s.clientSize.width+1,o=Math.min(u.frozen,u.length-1);o>0&&(f=u[o-1].pos,c+=f,v-=f);i.col=Math.min(u.length-1,Math.max(u.frozen,u.getItemAt(c)));i.col2=u.getItemAt(c+v)}return!n||this._ct!=1||r.frozen||u.frozen||(e=6,i.row<this._rng.row&&(i.row=Math.max(i.row-e,0)),i.row2>this._rng.row2&&(i.row2=Math.min(i.row2+e,r.length-1)),i.col<this._rng.col&&(i.col=Math.max(i.col-e,0)),i.col2>this._rng.col2&&(i.col2=Math.min(i.col2+e,u.length-1))),r.length<=r.frozen&&(i.row=i.row2=-1),u.length<=u.frozen&&(i.col=i.col2=-1),i},i.prototype._getFrozenPos=function(){var r=this._rows.frozen,u=this._cols.frozen,t=r>0?this._rows[r-1]:null,i=u>0?this._cols[u-1]:null,f=t?t.pos+t.renderSize:0,e=i?i.pos+i.renderSize:0;return new n.Point(e,f)},i}();t.GridPanel=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(){}return i.prototype.updateCell=function(r,u,f,e,o,s){var h=r.grid,p=r.cellType,d=r.rows,g=r.columns,y=d[u],c=g[f],ft=u,vt=f,w=n.tryCast(y,t.GroupRow),yt=n.tryCast(y,t._NewRowTemplate),pt=c.renderWidth,wt=y.renderHeight,a="wj-cell",l={display:""},bt=s!=!1,et,tt,ot,it,k,rt,v,ht,ct,b,lt,at,kt,nt,ii,dt,ut,gt;s!=!1&&e.firstElementChild&&(e.childNodes.length!=1||e.firstElementChild.type!="checkbox")&&(n.setText(e,null),bt=!1);o&&!o.isSingleCell&&(u=o.row,f=o.col,ft=o.bottomRow,vt=o.rightCol,y=d[u],c=g[f],w=n.tryCast(y,t.GroupRow),et=o.getRenderSize(r),wt=et.height,pt=et.width);tt=c.pos;ot=y.pos;u<d.frozen&&(ot-=h._ptScrl.y);f<g.frozen&&(tt-=h._ptScrl.x);h._rtl?l.right=tt+"px":l.left=tt+"px";l.top=ot-r._getOffsetY()+"px";l.width=pt+"px";l.height=wt+"px";p==1?(w&&(a+=" wj-group"),u%2!=0&&(a+=" wj-alt"),(u<d.frozen||f<g.frozen)&&(a+=" wj-frozen"),yt&&(a+=" wj-new"),y.cssClass&&(a+=" "+y.cssClass),c.cssClass&&(a+=" "+c.cssClass)):a+=" wj-header";it=r.getSelectedState(u,f,o);it!=0&&p==1&&c.dataType!=3&&h.editRange&&h.editRange.contains(u,f)&&(it=0);switch(it){case 2:a+=" wj-state-selected";break;case 1:a+=" wj-state-multi-selected"}if(ft==d.frozen-1&&(a+=" wj-frozen-row"),vt==g.frozen-1&&(a+=" wj-frozen-col"),(c.wordWrap||y.wordWrap)&&(a+=" wj-wrap"),bt&&a==e.className&&(k=e.style,k.top==l.top&&k.width==l.width&&k.height==l.height&&(h._rtl&&k.right==l.right||!h._rtl&&k.left==l.left))){k.display&&(e.style.display="");return}if(l.textAlign=c.getAlignment(),p==1&&(l.paddingLeft=l.paddingRight="",h.rows.maxGroupLevel>-1&&f==h.columns.firstVisibleIndex)){e.style.paddingLeft=e.style.paddingRight="";var ni=w?Math.max(0,w.level):h.rows.maxGroupLevel+1,ti=parseInt(getComputedStyle(e).paddingLeft),st=h.treeIndent*ni+ti;st&&(h._rtl?l.paddingRight=st:l.paddingLeft=st)}s!=!1&&(rt=r.getCellData(u,f,!1),v=r.getCellData(u,f,!0),p==1&&f==h.columns.firstVisibleIndex&&w&&w.hasChildren&&!this._isEditingCell(h,u,f)?(v||(v=this._getGroupHeader(w)),e.innerHTML=this._getTreeIcon(w)+" "+v,l.textAlign=""):p==2&&c.currentSort&&h.showSort&&ft==h._getSortRowIndex()?(a+=" wj-sort-"+(c.currentSort=="+"?"asc":"desc"),e.innerHTML=n.escapeHtml(v)+"&nbsp;"+this._getSortIcon(c)):p!=3||f!=h.rowHeaders.columns.length-1||v?p==1&&c.dataType==3&&(!w||n.isBoolean(rt))?(b=e.children?n.tryCast(e.children[0],HTMLInputElement):null,b&&b.type=="checkbox"||(e.innerHTML='<input type="checkbox"/>',b=n.tryCast(e.children[0],HTMLInputElement)),b.checked=rt==!0?!0:!1,b.indeterminate=rt==null,b.disabled=!h._edtHdl._allowEditing(u,f),b.disabled&&(b.style.cursor="default"),h.editRange&&h.editRange.contains(u,f)&&(h._edtHdl._edt=b)):p==1&&this._isEditingCell(h,u,f)?(lt=c.inputType,c.inputType||(lt=c.dataType==2&&!c.dataMap?"tel":"text"),c.dataMap||c.mask||(at=r.getCellData(u,f,!1),n.isNumber(at)&&(kt=c.format?c.format.replace(/(\d)+/g,"12"):null,v=n.Globalize.formatNumber(at,kt,!0))),e.innerHTML='<input type="'+lt+'" class="wj-grid-editor wj-form-control">',nt=e.children[0],nt.value=v,nt.style.textAlign=c.getAlignment(),l.padding="0px",c.mask&&(ii=new n._MaskProvider(nt,c.mask)),h._edtHdl._edt=nt):p==1&&(y.isContentHtml||c.isContentHtml)?e.innerHTML=v:n.setText(e,v):(ht=h.collectionView,ct=ht?ht.currentEditItem:null,ct&&y.dataItem==ct?v="âœŽ":n.tryCast(y,t._NewRowTemplate)&&(v="*"),n.setText(e,v)),p==1&&n.input&&c.dataMap&&c.showDropDown!==!1&&h._edtHdl._allowEditing(u,f)&&(i._ddIcon||(dt="position:absolute;top:0px;padding:3px 6px;opacity:.25;right:0px",i._ddIcon=n.createElement('<div style="'+dt+'" '+i._WJA_DROPDOWN+'><span class="wj-glyph-down"><\/span><\/div>')),ut=i._ddIcon.cloneNode(!0),h._rtl&&(ut.style.left="0px",ut.style.right=""),e.appendChild(ut)));switch(p){case 3:e.removeAttribute("draggable");w||yt||(h.allowDragging&2)==0||e.setAttribute("draggable","true");break;case 2:e.removeAttribute("draggable");(h.allowDragging&1)!=0&&e.setAttribute("draggable","true")}if(e.className!=a&&(e.className=a),n.setCss(e,l),h.itemFormatter&&h.itemFormatter(r,u,f,e),h.formatItem.hasHandlers){gt=new t.FormatItemEventArgs(r,new t.CellRange(u,f),e);h.onFormatItem(gt)}},i.prototype._isEditingCell=function(n,t,i){return n.editRange&&n.editRange.contains(t,i)},i.prototype._getGroupHeader=function(t){var f=t.grid,s=f.groupHeaderFormat?f.groupHeaderFormat:n.culture.FlexGrid.groupHeaderFormat,u=n.tryCast(t.dataItem,n.collections.CollectionViewGroup);if(u&&s){var e=u.groupDescription.propertyName,r=u.name,i=f.columns.getColumn(e),o=t.isContentHtml;return i&&(o=o||i.isContentHtml,i.header&&(e=i.header),i.dataMap?r=i.dataMap.getDisplayValue(r):i.format&&(r=n.Globalize.format(r,i.format))),n.format(s,{name:n.escapeHtml(e),value:o?r:n.escapeHtml(r),level:u.level,count:u.items.length})}return""},i.prototype._getTreeIcon=function(n){var t="wj-glyph-"+(n.grid._rtl?n.isCollapsed?"left":"down-left":n.isCollapsed?"right":"down-right");return"<span "+i._WJA_COLLAPSE+' class="'+t+'"><\/span>'},i.prototype._getSortIcon=function(n){return'<span class="wj-glyph-'+(n.currentSort=="+"?"up":"down")+'"><\/span>'},i._WJA_COLLAPSE="wj-collapse",i._WJA_DROPDOWN="wj-dropdown",i}();t.CellFactory=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function t(t,i,r,u){typeof t=="undefined"&&(t=-1);typeof i=="undefined"&&(i=-1);typeof r=="undefined"&&(r=t);typeof u=="undefined"&&(u=i);this._row=n.asInt(t);this._col=n.asInt(i);this._row2=n.asInt(r);this._col2=n.asInt(u)}return Object.defineProperty(t.prototype,"row",{get:function(){return this._row},set:function(t){this._row=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._col},set:function(t){this._col=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row2",{get:function(){return this._row2},set:function(t){this._row2=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col2",{get:function(){return this._col2},set:function(t){this._col2=n.asInt(t)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this._row,this._col,this._row2,this._col2)},Object.defineProperty(t.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0}),t.prototype.contains=function(i,r){var u=n.tryCast(i,t);if(u)return u.topRow>=this.topRow&&u.bottomRow<=this.bottomRow&&u.leftCol>=this.leftCol&&u.rightCol<=this.rightCol;if(n.isInt(i)&&n.isInt(r))return i>=this.topRow&&i<=this.bottomRow&&r>=this.leftCol&&r<=this.rightCol;throw"contains expects a CellRange or row/column indices.";},t.prototype.containsRow=function(t){return n.asInt(t),t>=this.topRow&&t<=this.bottomRow},t.prototype.containsColumn=function(t){return n.asInt(t),t>=this.leftCol&&t<=this.rightCol},t.prototype.intersects=function(n){return this.rightCol<n.leftCol||this.leftCol>n.rightCol||this.bottomRow<n.topRow||this.topRow>n.bottomRow?!1:!0},t.prototype.getRenderSize=function(t){var u=new n.Size(0,0),i,r;if(this.isValid){for(i=this.topRow;i<=this.bottomRow;i++)u.height+=t.rows[i].renderSize;for(r=this.leftCol;r<=this.rightCol;r++)u.width+=t.columns[r].renderSize}return u},t.prototype.equals=function(n){return n instanceof t&&this._row==n._row&&this._col==n._col&&this._row2==n._row2&&this._col2==n._col2},t}();t.CellRange=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";var f,r,i,e,o,u,s,h;(function(n){n[n.Visible=1]="Visible";n[n.AllowResizing=2]="AllowResizing";n[n.AllowDragging=4]="AllowDragging";n[n.AllowMerging=8]="AllowMerging";n[n.AllowSorting=16]="AllowSorting";n[n.AutoGenerated=32]="AutoGenerated";n[n.Collapsed=64]="Collapsed";n[n.ParentCollapsed=128]="ParentCollapsed";n[n.Selected=256]="Selected";n[n.ReadOnly=512]="ReadOnly";n[n.HtmlContent=1024]="HtmlContent";n[n.WordWrap=2048]="WordWrap";n[n.RowDefault=n.Visible|n.AllowResizing]="RowDefault";n[n.ColumnDefault=n.Visible|n.AllowDragging|n.AllowResizing|n.AllowSorting]="ColumnDefault"})(t.RowColFlags||(t.RowColFlags={}));f=t.RowColFlags;r=function(){function t(){this._list=null;this._pos=0;this._idx=-1}return Object.defineProperty(t.prototype,"visible",{get:function(){return this._getFlag(1)},set:function(n){this._setFlag(1,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._getFlag(1)&&!this._getFlag(128)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pos",{get:function(){return this._list&&this._list._update(),this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._list&&this._list._update(),this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._sz},set:function(t){t!=this._sz&&(this._sz=n.asNumber(t,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSize",{get:function(){if(!this.isVisible)return 0;var n=this._sz,t=this._list;return(n==null||n<0)&&t!=null?Math.round(t.defaultSize):(t!=null&&(t.minSize!=null&&n<t.minSize&&(n=t.minSize),t.maxSize!=null&&n>t.maxSize&&(n=t.maxSize)),this._szMin!=null&&n<this._szMin&&(n=this._szMin),this._szMax!=null&&n>this._szMax&&(n=this._szMax),Math.round(n))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowResizing",{get:function(){return this._getFlag(2)},set:function(n){this._setFlag(2,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowDragging",{get:function(){return this._getFlag(4)},set:function(n){this._setFlag(4,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowMerging",{get:function(){return this._getFlag(8)},set:function(n){this._setFlag(8,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._getFlag(256)},set:function(n){this._setFlag(256,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._getFlag(512)},set:function(n){this._setFlag(512,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._getFlag(1024)},set:function(n){this.isContentHtml!=n&&(this._setFlag(1024,n),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._getFlag(2048)},set:function(n){this._setFlag(2048,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){t!=this._cssClass&&(this._cssClass=n.asString(t),this.grid&&this.grid.invalidate(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0}),t.prototype.onPropertyChanged=function(){this._list&&(this._list._dirty=!0,this.grid.invalidate())},t.prototype._getFlag=function(n){return(this._f&n)!=0},t.prototype._setFlag=function(n,t,i){return t!=this._getFlag(n)?(this._f=t?this._f|n:this._f&~n,i||this.onPropertyChanged(),!0):!1},t}();t.RowCol=r;i=function(i){function r(t){i.call(this);this._f=f.ColumnDefault;this._hash=r._ctr.toString(36);r._ctr++;t&&n.copy(this,t)}return __extends(r,i),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},set:function(n){this._name=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataType",{get:function(){return this._type},set:function(t){this._type!=t&&(this._type=n.asEnum(t,n.DataType),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"required",{get:function(){return this._required},set:function(t){this._required=n.asBoolean(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showDropDown",{get:function(){return this._showDropDown},set:function(t){t!=this._showDropDown&&(this._showDropDown=n.asBoolean(t,!0),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputType",{get:function(){return this._inpType},set:function(t){this._inpType=n.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=n.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(t){var r,i,u;t!=this.binding&&(r=n.asString(t),this._binding=r?new n.Binding(r):null,!this._type&&this.grid&&this._binding&&(i=this.grid.collectionView,i&&i.sourceCollection&&i.sourceCollection.length&&(u=i.sourceCollection[0],this._type=n.getType(this._binding.getValue(u)))),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sortMemberPath",{get:function(){return this._bindingSort?this._bindingSort.path:null},set:function(t){if(t!=this.sortMemberPath){var i=n.asString(t);this._bindingSort=i?new n.Binding(i):null;this.onPropertyChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._szStar!=null?this._szStar:this.size},set:function(t){r._parseStarSize(t)!=null?(this._szStar=t,this.onPropertyChanged()):(this._szStar=null,this.size=n.asNumber(t,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minWidth",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=n.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=n.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"align",{get:function(){return this._align},set:function(n){this._align!=n&&(this._align=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),r.prototype.getAlignment=function(){var n=this._align;if(n==null&&(n="",!this._map))switch(this._type){case 3:n="center";break;case 2:n="right"}return n},Object.defineProperty(r.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(n){this._hdr!=n&&(this._hdr=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataMap",{get:function(){return this._map},set:function(i){this._map!=i&&(this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this),n.isArray(i)&&(i=new t.DataMap(i,null,null)),this._map=n.asType(i,t.DataMap,!0),this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"format",{get:function(){return this._fmt},set:function(n){this._fmt!=n&&(this._fmt=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowSorting",{get:function(){return this._getFlag(16)},set:function(n){this._setFlag(16,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentSort",{get:function(){var t,n;if(this.grid&&this.grid.collectionView&&this.grid.collectionView.canSort)for(t=this.grid.collectionView.sortDescriptions,n=0;n<t.length;n++)if(t[n].property==this._getBindingSort())return t[n].ascending?"+":"-";return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"aggregate",{get:function(){return this._agg!=null?this._agg:0},set:function(t){t!=this._agg&&(this._agg=n.asEnum(t,n.Aggregate),this.onPropertyChanged())},enumerable:!0,configurable:!0}),r.prototype._getBindingSort=function(){return this.sortMemberPath?this.sortMemberPath:this.binding?this.binding:null},r._parseStarSize=function(t){if(n.isString(t)&&t.length>0&&t[t.length-1]=="*"){var i=t.length==1?1:t.substr(0,t.length-1)*1;if(i>0&&!isNaN(i))return i}return null},r._ctr=0,r}(r);t.Column=i;e=function(n){function t(t){n.call(this);this._f=f.ColumnDefault;this._data=t}return __extends(t,n),Object.defineProperty(t.prototype,"dataItem",{get:function(){return this._data},set:function(n){this._data=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size},set:function(n){this.size=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),t}(r);t.Row=e;o=function(t){function i(){t.call(this);this._level=-1;this.isReadOnly=!0}return __extends(i,t),Object.defineProperty(i.prototype,"level",{get:function(){return this._level},set:function(t){n.asInt(t);t!=this._level&&(this._level=t,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasChildren",{get:function(){var t=null,i=null;return this.grid!=null&&this._list!=null?(this._list._update(),this.index<this._list.length-1&&(t=this._list[this.index+1]),i=n.tryCast(t,n.grid.GroupRow),t&&(i==null||i.level>this.level)):!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCollapsed",{get:function(){return this._getFlag(64)},set:function(t){n.asBoolean(t);t!=this.isCollapsed&&this._list!=null&&this._setCollapsed(t)},enumerable:!0,configurable:!0}),i.prototype._setCollapsed=function(t){var o=this,i=this.grid,u=i.rows,e=this.getCellRange(),f=new n.grid.CellRangeEventArgs(i.cells,new n.grid.CellRange(this.index,-1)),r;i.onGroupCollapsedChanging(f);if(!f.cancel){i.deferUpdate(function(){o._setFlag(64,t);for(var i=e.topRow+1;i<=e.bottomRow&&i>-1&&i<u.length;i++)u[i]._setFlag(128,t),r=n.tryCast(u[i],n.grid.GroupRow),r!=null&&r.isCollapsed&&(i=r.getCellRange().bottomRow)});i.onGroupCollapsedChanged(f)}},i.prototype.getCellRange=function(){for(var r,u=this._list,f=this.index,i=u.length-1,t=f+1;t<=i;t++)if(r=n.tryCast(u[t],n.grid.GroupRow),r!=null&&r.level<=this.level){i=t-1;break}return new n.grid.CellRange(f,0,i,this.grid.columns.length-1)},i}(e);t.GroupRow=o;u=function(i){function r(t,r){i.call(this);this._frozen=0;this._szDef=28;this._szTot=0;this._dirty=!1;this._g=n.asType(t,n.grid.FlexGrid);this._szDef=n.asNumber(r,!1,!0)}return __extends(r,i),Object.defineProperty(r.prototype,"defaultSize",{get:function(){return this._szDef},set:function(t){this._szDef!=t&&(this._szDef=n.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frozen",{get:function(){return this._frozen},set:function(t){t!=this._frozen&&(this._frozen=n.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),r.prototype.isFrozen=function(n){return n<this.frozen},Object.defineProperty(r.prototype,"minSize",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=n.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxSize",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=n.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),r.prototype.getTotalSize=function(){return this._update(),this._szTot},r.prototype.getItemAt=function(n){if(this._update(),n<=0&&this.length>0)return 0;for(var u=0,i=this.length-1,t,r;u<=i;)if(t=u+i>>>1,r=this[t],r._pos>n)i=t-1;else if(r._pos+r.renderSize<n)u=t+1;else return t;return i},r.prototype.getNextCell=function(n,t,i){var r,u;switch(t){case 1:for(r=n+1;r<this.length;r++)if(this[r].renderSize>0)return r;break;case 2:for(r=n-1;r>=0;r--)if(this[r].renderSize>0)return r;break;case 6:for(r=this.length-1;r>=0;r--)if(this[r].renderSize>0)return r;break;case 5:for(r=0;r<this.length;r++)if(this[r].renderSize>0)return r;break;case 3:return u=this.getItemAt(this[n].pos+i),u<0?this.getNextCell(n,6,i):u;case 4:return u=this.getItemAt(this[n].pos-i),u<0?this.getNextCell(n,5,i):u}return n},r.prototype.canMoveElement=function(n,i){var u,f,r;if(i==n||n<0||n>=this.length||i>=this.length)return!1;for(i<0&&(i=this.length-1),u=Math.min(n,i),f=Math.max(n,i),r=u;r<=f;r++)if(!this[r].allowDragging)return!1;return this[i]instanceof t._NewRowTemplate?!1:!0},r.prototype.moveElement=function(n,t){if(this.canMoveElement(n,t)){var i=this[n];this.removeAt(n);t<0&&(t=this.length);this.insert(t,i)}},r.prototype.onCollectionChanged=function(t){typeof t=="undefined"&&(t=n.collections.NotifyCollectionChangedEventArgs.reset);this._dirty=!0;this._g.invalidate();i.prototype.onCollectionChanged.call(this,t)},r.prototype.push=function(n){return n._list=this,i.prototype.push.call(this,n)},r.prototype.splice=function(n,t,r){return r&&(r._list=this),i.prototype.splice.call(this,n,t,r)},r.prototype.beginUpdate=function(){this._update();i.prototype.beginUpdate.call(this)},r.prototype._update=function(){var i,n,t;if(this._dirty&&!this.isUpdating){for(this._dirty=!1,i=0,t=0;t<this.length;t++)n=this[t],n._idx=t,n._list=this,n._pos=i,i+=n.renderSize;return this._szTot=i,!0}return!1},r}(n.collections.ObservableArray);t.RowColCollection=u;s=function(n){function t(){n.apply(this,arguments);this._firstVisible=-1}return __extends(t,n),t.prototype.getColumn=function(n){var t=this.indexOf(n);return t>-1?this[t]:null},t.prototype.indexOf=function(t){var r;if(t instanceof i)return n.prototype.indexOf.call(this,t);for(r=0;r<this.length;r++)if(this[r].name==t)return r;for(r=0;r<this.length;r++)if(this[r].binding==t)return r;return-1},Object.defineProperty(t.prototype,"firstVisibleIndex",{get:function(){return this._update(),this._firstVisible},enumerable:!0,configurable:!0}),t.prototype._update=function(){if(n.prototype._update.call(this)){this._firstVisible=-1;for(var t=0;t<this.length;t++)if(this[t].visible){this._firstVisible=t;break}return!0}return!1},t.prototype._updateStarSizes=function(n){for(var e=0,t,u,f,r=0;r<this.length;r++)t=this[r],t.isVisible&&(t._szStar?(e+=i._parseStarSize(t._szStar),u=t):n-=t.renderWidth);if(u!=null){for(f=n,r=0;r<this.length;r++)t=this[r],t.isVisible&&t._szStar&&(t==u?t._sz=f:(t._sz=Math.max(0,Math.round(i._parseStarSize(t._szStar)/e*n)),f-=t.renderWidth));return this._dirty=!0,this._update(),!0}return!1},t}(u);t.ColumnCollection=s;h=function(t){function i(){t.apply(this,arguments);this._maxLevel=-1}return __extends(i,t),Object.defineProperty(i.prototype,"maxGroupLevel",{get:function(){return this._update(),this._maxLevel},enumerable:!0,configurable:!0}),i.prototype._update=function(){var i,r;if(t.prototype._update.call(this)){for(this._maxLevel=-1,i=0;i<this.length;i++)r=n.tryCast(this[i],n.grid.GroupRow),r&&r.level>this._maxLevel&&(this._maxLevel=r.level);return!0}return!1},i}(u);t.RowCollection=h})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(r,u){var f,h,c;if(this._row=-1,this._col=-1,this._edge=0,r instanceof t.FlexGrid)this._g=r;else if(r instanceof t.GridPanel)this._p=r,r=this._g=this._p.grid;else throw"First parameter should be a FlexGrid or GridPanel.";u=n.mouseToPage(u);this._pt=u.clone();var l=r.controlRect,p=r.topLeftCells,w=r.scrollPosition,a=r.clientSize,b=r.headersVisibility,e=b&2?p.columns.getTotalSize():0,o=b&1?p.rows.getTotalSize():0;if(u.x-=l.left,u.y-=l.top,this._g._rtl&&(u.x=l.width-u.x),this._p==null&&u.x>=0&&u.y>=0&&a&&u.x<=a.width+e&&u.y<=a.height+o&&(this._p=u.x<=e&&u.y<=o?r.topLeftCells:u.x<=e?r.rowHeaders:u.y<=o?r.columnHeaders:r.cells),this._p!=null){var v=this._p.rows,y=this._p.columns,s=this._p.cellType,k=this._p._getFrozenPos();if((s==1||s==3)&&(u.y-=o,u.y>k.y&&(u.y=u.y-w.y+this._p._getOffsetY())),(s==1||s==2)&&(u.x-=e,u.x>k.x&&(u.x-=w.x)),this._row=u.y>v.getTotalSize()?-1:v.getItemAt(u.y),this._col=u.x>y.getTotalSize()?-1:y.getItemAt(u.x),this._row<0||this._col<0){this._p=null;return}this._edge=0;f=i._EDGESIZE;this._col>-1&&(h=y[this._col],u.x-h.pos-u.x<=f&&(this._edge|=1),h.pos+h.renderSize-u.x<=f&&(this._edge|=4));this._row>-1&&(c=v[this._row],u.y-c.pos-u.y<=f&&(this._edge|=2),c.pos+c.renderSize-u.y<=f&&(this._edge|=8))}}return Object.defineProperty(i.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellType",{get:function(){return this._p?this._p.cellType:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"range",{get:function(){return new t.CellRange(this._row,this._col)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeLeft",{get:function(){return(this._edge&1)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeTop",{get:function(){return(this._edge&2)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeRight",{get:function(){return(this._edge&4)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeBottom",{get:function(){return(this._edge&8)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gridPanel",{get:function(){return console.error('** This property is deprecated. Please use the "panel" property instead.'),this._p},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellRange",{get:function(){return console.error('** This property is deprecated. Please use the "range" property instead.'),new t.CellRange(this._row,this._col)},enumerable:!0,configurable:!0}),i._EDGESIZE=5,i}();t.HitTestInfo=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";(function(n){n[n.None=0]="None";n[n.Cells=1]="Cells";n[n.ColumnHeaders=2]="ColumnHeaders";n[n.RowHeaders=4]="RowHeaders";n[n.AllHeaders=n.ColumnHeaders|n.RowHeaders]="AllHeaders";n[n.All=n.Cells|n.AllHeaders]="All"})(t.AllowMerging||(t.AllowMerging={}));var i=t.AllowMerging,r=function(){function r(n){this._g=n}return r.prototype.getMergedRange=function(r,u,f,e){var y,tt,d,a,v,it,g,l,k,w,b;typeof e=="undefined"&&(e=!0);var o,p,c=r.cellType,s=r.columns,h=r.rows,nt=h[u],rt=s[f];if(nt instanceof t._NewRowTemplate)return null;if(nt instanceof t.GroupRow&&nt.dataItem instanceof n.collections.CollectionViewGroup){if(o=new t.CellRange(u,f),rt.aggregate==0){while(o.col>0&&s[o.col-1].aggregate==0&&o.col!=s.frozen)o.col--;while(o.col2<s.length-1&&s[o.col2+1].aggregate==0&&o.col2+1!=s.frozen)o.col2++}while(o.col<f&&!s[o.col].visible)o.col++;return o.isSingleCell?null:o}y=!1;switch(this._g.allowMerging){case 0:y=!0;break;case 1:y=c!=1;break;case 2:y=c!=2&&c!=4;break;case 4:y=c!=3&&c!=4;break;case i.AllHeaders:y=c==1}if(y)return null;if(s[f].allowMerging){for(o=new t.CellRange(u,f),tt=0,d=h.length-1,u>=h.frozen?e&&(c==1||c==3)&&(p=r._getViewRange(!0),tt=p.topRow,d=p.bottomRow):d=h.frozen-1,l=r.getCellData(u,f,!0),k=h.isFrozen(u),a=u-1;l!=null&&a>=tt;a--){if(h[a]instanceof t.GroupRow||h[a]instanceof t._NewRowTemplate||h.isFrozen(a)!=k||r.getCellData(a,f,!0)!==l)break;o.row=a}for(v=u+1;l!=null&&v<=d;v++){if(h[v]instanceof t.GroupRow||h[v]instanceof t._NewRowTemplate||h.isFrozen(v)!=k||r.getCellData(v,f,!0)!==l)break;o.row2=v}while(o.row<u&&!h[o.row].visible)o.row++;if(!o.isSingleCell)return o}if(h[u].allowMerging){for(o=new t.CellRange(u,f),it=0,g=s.length-1,f>=s.frozen?e&&(c==1||c==2)&&(p=r._getViewRange(!0),it=p.leftCol,g=p.rightCol):g=s.frozen-1,l=r.getCellData(u,f,!0),k=s.isFrozen(f),w=f-1;w>=it;w--){if(s.isFrozen(w)!=k||r.getCellData(u,w,!0)!==l)break;o.col=w}for(b=f+1;b<=g;b++){if(s.isFrozen(b)||r.getCellData(u,b,!0)!==l)break;o.col2=b}while(o.col<f&&!s[o.col].visible)o.col++;if(!o.isSingleCell)return o}return null},r.prototype.implementsInterface=function(n){return n=="IMergeManager"},r}();t.MergeManager=r})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function t(t,i,r){var f,u;if(this.mapChanged=new n.Event,n.isArray(t)&&!i&&!r){for(f=[],u=0;u<t.length;u++)f.push({value:t[u]});t=f;i="value";r="value"}this._cv=n.asCollectionView(t);this._keyPath=n.asString(i,!1);this._displayPath=n.asString(r,!1);this._cv.collectionChanged.addHandler(this.onMapChanged,this)}return Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0}),t.prototype.getKeyValue=function(n){var t=this._indexOf(n,this._displayPath,!1);return t>-1?this._cv.sourceCollection[t][this._keyPath]:null},t.prototype.getDisplayValue=function(n){var t=this._indexOf(n,this._keyPath,!0);return t>-1?this._cv.sourceCollection[t][this._displayPath]:n},t.prototype.getDisplayValues=function(){var i=[],t,n;if(this._cv&&this._displayPath)for(t=this._cv.sourceCollection,n=0;n<t.length;n++)i.push(t[n][this._displayPath]);return i},t.prototype.getKeyValues=function(){var i=[],t,n;if(this._cv&&this._keyPath)for(t=this._cv.sourceCollection,n=0;n<t.length;n++)i.push(t[n][this._keyPath]);return i},t.prototype.onMapChanged=function(){this.mapChanged.raise(this)},t.prototype._indexOf=function(n,t,i){var f,r,u;if(this._cv&&t)for(i||(n=n.toString().toLowerCase()),f=this._cv.sourceCollection,r=0;r<f.length;r++)if((u=f[r][t],u==n)||!i&&u.length==n.length&&u.toLowerCase()==n)return r;return-1},t}();t.DataMap=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var r,u,f,i;(function(n){n[n.None=0]="None";n[n.Cell=1]="Cell";n[n.CellRange=2]="CellRange";n[n.Row=3]="Row";n[n.RowRange=4]="RowRange";n[n.ListBox=5]="ListBox"})(t.SelectionMode||(t.SelectionMode={}));r=t.SelectionMode,function(n){n[n.None=0]="None";n[n.Selected=1]="Selected";n[n.Cursor=2]="Cursor"}(t.SelectedState||(t.SelectedState={}));u=t.SelectedState,function(n){n[n.None=0]="None";n[n.Next=1]="Next";n[n.Prev=2]="Prev";n[n.NextPage=3]="NextPage";n[n.PrevPage=4]="PrevPage";n[n.Home=5]="Home";n[n.End=6]="End";n[n.NextCell=7]="NextCell";n[n.PrevCell=8]="PrevCell"}(t.SelMove||(t.SelMove={}));f=t.SelMove;i=function(){function i(n){this._sel=new t.CellRange(0,0);this._mode=2;this._g=n}return Object.defineProperty(i.prototype,"selectionMode",{get:function(){return this._mode},set:function(n){var i,t;if(n!=this._mode){if(n==5||this._mode==5)for(i=this._g.rows,t=0;t<i.length;t++)i[t]._setFlag(256,n==5?this._sel.containsRow(t):!1,!1);this._mode=n;this._g.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selection",{get:function(){return this._sel},set:function(n){this.select(n)},enumerable:!0,configurable:!0}),i.prototype.getSelectedState=function(n,t){if(this._mode==0)return 0;var i=this._sel,r=this._g,u=r.getMergedRange(r.cells,n,t);if(u){if(u.contains(i.row,i.col))return r.showMarquee?0:2;if(u.intersects(i))return 1}return i.row==n&&i.col==t?r.showMarquee?0:2:r.rows[n].isSelected||r.columns[t].isSelected?1:(i=this._adjustSelection(i),this._mode==5)?0:i.containsRow(n)&&i.containsColumn(t)?1:0},i.prototype.select=function(i,r){var e,o,s;typeof r=="undefined"&&(r=!0);n.isNumber(i)&&n.isNumber(r)&&(i=new t.CellRange(i,r),r=!0);i=n.asType(i,t.CellRange);var u=this._g,h=this._sel,f=i;switch(u.selectionMode){case 1:i.row2=i.row;i.col2=i.col;break;case 3:i.row2=i.row;break;case 5:for(e=0;e<u.rows.length;e++)u.rows[e]._setFlag(256,f.containsRow(e),!1);u.refreshCells(!1,!0,!0)}if(f.equals(h)){r&&u.scrollIntoView(f.row,f.col);return}if(o=new t.CellRangeEventArgs(u.cells,f),u.onSelectionChanging(o)){f.row=Math.min(f.row,u.rows.length-1);f.row2=Math.min(f.row2,u.rows.length-1);this._sel=f;u.refreshCells(!1,!0,!0);r&&u.scrollIntoView(f.row,f.col);u.collectionView&&(s=u._getCvIndex(f.row),u.collectionView.moveCurrentToPosition(s));u.onSelectionChanged(o)}},i.prototype.moveSelection=function(n,i,r){var f,u,s=this._g,c=s.rows,h=s.columns,e=this._getReferenceCell(n,i,r),o=Math.max(0,s.clientSize.height-s.columnHeaders.height),l;i==7?(u=h.getNextCell(e.col,1,o),f=e.row,u==e.col&&(f=c.getNextCell(f,1,o),f>e.row&&(u=h.getNextCell(0,1,o),u=h.getNextCell(u,2,o))),s.select(f,u)):i==8?(u=h.getNextCell(e.col,2,o),f=e.row,u==e.col&&(f=c.getNextCell(f,2,o),f<e.row&&(u=h.getNextCell(h.length-1,2,o),u=h.getNextCell(u,1,o))),s.select(f,u)):(f=c.getNextCell(e.row,n,o),u=h.getNextCell(e.col,i,o),r?(l=s.selection,s.select(new t.CellRange(f,u,l.row2,l.col2))):s.select(f,u))},i.prototype._getReferenceCell=function(n,t){var u=this._g,r=u.selection,i=u.getMergedRange(u.cells,r.row,r.col);if(!i||i.isSingleCell)return r;i=i.clone();switch(n){case 1:case 7:i.row=i.bottomRow;break;case 0:i.row=r.row}switch(t){case 1:case 7:i.col=i.rightCol;break;case 0:i.col=r.col}return i},i.prototype._adjustSelection=function(n){switch(this._mode){case 1:return new t.CellRange(n.row,n.col,n.row,n.col);case 3:return new t.CellRange(n.row,0,n.row,this._g.columns.length-1);case 4:case 5:return new t.CellRange(n.row,0,n.row2,this._g.columns.length-1)}return n},i}();t._SelectionHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(n){this._g=n;n.addEventListener(n.hostElement,"keypress",this._keypress.bind(this));n.addEventListener(n.hostElement,"keydown",this._keydown.bind(this))}return i.prototype._keydown=function(i){var r=this._g,e=r.selection,f=i.ctrlKey||i.metaKey,u=i.shiftKey,h=!0,a,l;if(r.isRangeValid(e)&&!i.defaultPrevented){if(r.activeEditor&&r._edtHdl._keydown(i))return;var c=n.tryCast(r.rows[e.row],t.GroupRow),o=n.tryCast(r.collectionView,"IEditableCollectionView"),s=i.keyCode;if(r.autoClipboard){if(f&&(s==67||s==45)){if(l=new t.CellRangeEventArgs(r.cells,e),r.onCopying(l)){a=r.getClipString();n.Clipboard.copy(a);r.onCopied(l)}i.stopPropagation();return}if(f&&s==86||u&&s==45){r.isReadOnly||(l=new t.CellRangeEventArgs(r.cells,e),r.onPasting(l)&&n.Clipboard.paste(function(n){r.setClipString(n);r.onPasted(l)}));i.stopPropagation();return}}if(r._rtl)switch(s){case 37:s=39;break;case 39:s=37}switch(s){case 65:f?r.select(new t.CellRange(0,0,r.rows.length-1,r.columns.length-1)):h=!1;break;case 37:e.isValid&&e.col==0&&c!=null&&!c.isCollapsed&&c.hasChildren?c.isCollapsed=!0:this._moveSel(0,f?5:2,u);break;case 39:e.isValid&&e.col==0&&c!=null&&c.isCollapsed?c.isCollapsed=!1:this._moveSel(0,f?6:1,u);break;case 38:this._moveSel(f?5:2,0,u);break;case 40:this._moveSel(f?6:1,0,u);break;case 33:this._moveSel(4,0,u);break;case 34:this._moveSel(3,0,u);break;case 36:this._moveSel(f?5:0,5,u);break;case 35:this._moveSel(f?6:0,6,u);break;case 9:this._moveSel(0,u?8:7,!1);break;case 13:this._moveSel(u?2:1,0,!1);!u&&o&&o.currentEditItem!=null&&o.commitEdit();break;case 27:o&&(o.currentEditItem!=null&&o.cancelEdit(),o.currentAddItem!=null&&o.cancelNew());r._mouseHdl.resetMouseState();break;case 46:h=this._deleteSel();break;case 113:h=r.startEditing(!0);break;case 32:h=r.startEditing(!0);h&&setTimeout(function(){var t=r.activeEditor,i;t&&(t.type=="checkbox"?(t.checked=!t.checked,r.finishEditing()):(i=t.value.length,n.setSelectionRange(t,i,i)))});break;default:h=!1}h&&(i.preventDefault(),i.stopPropagation())}},i.prototype._keypress=function(t){var i=this._g;i.activeEditor?i._edtHdl._keypress(t):t.charCode>32&&i.startEditing(!1)&&i.activeEditor&&(i.columns[i.editRange.col].mask||setTimeout(function(){var r=i.activeEditor;r&&r.type!="checkbox"&&(r.value=String.fromCharCode(t.charCode),n.setSelectionRange(r,1,1),i._edtHdl._keypress(t))}));t.stopPropagation()},i.prototype._moveSel=function(n,t,i){this._g.selectionMode!=0&&this._g._selHdl.moveSelection(n,t,i)},i.prototype._deleteSel=function(){var i=this._g,f=n.tryCast(i.collectionView,"IEditableCollectionView"),u=i.selection,o=i.rows,e=[],h,l,r,s,c;if(i.allowDelete&&!i.isReadOnly&&(f==null||f.canRemove&&!f.isAddingNew&&!f.isEditingItem))switch(i.selectionMode){case 2:if(u.leftCol==0&&u.rightCol==i.columns.length-1)for(r=u.topRow;r>-1&&r<=u.bottomRow;r++)e.push(o[r]);break;case 5:for(r=0;r<o.length;r++)o[r].isSelected&&e.push(o[r]);break;case 3:u.topRow>-1&&e.push(o[u.topRow]);break;case 4:for(r=u.topRow;r>-1&&r<=u.bottomRow;r++)e.push(o[r])}if(e.length>0){for(f&&f.beginUpdate(),i.beginUpdate(),h=new t.CellRange,l=new t.CellRangeEventArgs(i.cells,h),r=e.length-1;r>=0;r--){s=e[r];h.row=h.row2=s.index;i.onDeletingRow(l);l.cancel||(f&&s.dataItem?f.remove(s.dataItem):i.rows.removeAt(s.index))}return i.endUpdate(),f&&f.endUpdate(),i.selectionMode==5&&(c=i.selection.row,c>-1&&c<i.rows.length&&(i.rows[c].isSelected=!0)),i.childItemsPath&&i.collectionView&&i.collectionView.refresh(),!0}return!i.isReadOnly&&e.length==0&&u.isSingleCell&&i.getCellData(u.row,u.col,!0)&&i.startEditing(!1,u.row,u.col)?(i.setCellData(u.row,u.col,"",!0),i.finishEditing(!0),i.invalidate(),!0):!1},i}();t._KeyboardHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var r,u,f,i;(function(n){n[n.None=0]="None";n[n.Columns=1]="Columns";n[n.Rows=2]="Rows";n[n.Both=n.Rows|n.Columns]="Both"})(t.AllowResizing||(t.AllowResizing={}));r=t.AllowResizing,function(n){n[n.None=0]="None";n[n.Headers=1]="Headers";n[n.Cells=2]="Cells";n[n.Both=n.Headers|n.Cells]="Both"}(t.AutoSizeMode||(t.AutoSizeMode={}));u=t.AutoSizeMode,function(n){n[n.None=0]="None";n[n.Columns=1]="Columns";n[n.Rows=2]="Rows";n[n.Both=n.Rows|n.Columns]="Both"}(t.AllowDragging||(t.AllowDragging={}));f=t.AllowDragging;i=function(){function i(t){var i,r,u,f;this._g=t;i=t.hostElement;r=this;t.addEventListener(i,"mousedown",function(n){n.button==0&&(document.addEventListener("mousemove",u),document.addEventListener("mouseup",f),r._mouseDown(n))});u=function(n){r._mouseMove(n)};f=function(n){document.removeEventListener("mousemove",u);document.removeEventListener("mouseup",f);r._mouseUp(n)};t.addEventListener(i,"mousemove",this._hover.bind(this));t.addEventListener(i,"dblclick",this._dblClick.bind(this));t.addEventListener(i,"selectstart",function(n){n.target.tagName!="INPUT"&&n.preventDefault()});t.addEventListener(i,"dragstart",this._dragStart.bind(this));t.addEventListener(i,"dragover",this._dragOver.bind(this));t.addEventListener(i,"dragleave",this._dragOver.bind(this));t.addEventListener(i,"drop",this._drop.bind(this));t.addEventListener(i,"dragend",this._dragEnd.bind(this));this._dvMarker=n.createElement('<div class="wj-marker">&nbsp;<\/div>')}return i.prototype.resetMouseState=function(){this._dragSource&&(this._dragSource.style.opacity=1);this._showDragMarker(null);this._htDown=null;this._lbSelRows=null;this._szRowCol=null;this._szArgs=null;this._dragSource=null;this._g.hostElement.style.cursor="default"},i.prototype._mouseDown=function(i){var u=this._g,r,f,e,o;if((u._rcBounds=null,r=u.hitTest(i),!i.defaultPrevented&&r.cellType!=0)&&(!u.editRange||!u.editRange.contains(r.range))){if(this._htDown=r,this._eMouse=i,i.target!=document.activeElement&&!u.containsFocus()){for(f=i.target;f instanceof Node&&!n.hasClass(f,"wj-cell");)f=f.parentNode;r.panel==u.cells&&f instanceof HTMLElement?f.focus():r.panel?r.panel.hostElement.parentElement.focus():u.focus()}if(this._szRowCol!=null){this._handleResizing(i);return}switch(r.cellType){case 1:i.ctrlKey&&u.selectionMode==5&&this._startListBoxSelection(r.row);this._mouseSelect(i,i.shiftKey);break;case 3:(this._g.allowDragging&2)==0&&(i.ctrlKey&&u.selectionMode==5&&this._startListBoxSelection(r.row),this._mouseSelect(i,i.shiftKey))}if(r.cellType==1&&r.col==u.columns.firstVisibleIndex&&(e=n.tryCast(u.rows[r.row],t.GroupRow),e&&(o=document.elementFromPoint(i.clientX,i.clientY),n.closest(o,"["+t.CellFactory._WJA_COLLAPSE+"]")))){i.ctrlKey?u.collapseGroupsToLevel(e.isCollapsed?e.level+1:e.level):e.isCollapsed=!e.isCollapsed;this.resetMouseState();i.preventDefault();return}}},i.prototype._mouseMove=function(n){if(this._htDown!=null)if(this._eMouse=n,this._szRowCol)this._handleResizing(n);else switch(this._htDown.cellType){case 1:this._mouseSelect(n,!0);break;case 3:(this._g.allowDragging&2)==0&&this._mouseSelect(n,!0)}},i.prototype._mouseUp=function(n){var r=this._htDown,i,u;r&&r.cellType==4&&r.row==0&&r.col==0&&!this._szArgs?(i=this._g,u=i.hitTest(n),u.cellType==4&&u.row==0&&u.col==0&&i.select(new t.CellRange(0,0,i.rows.length-1,i.columns.length-1))):this._szArgs?this._finishResizing(n):this._handleSort(n);this.resetMouseState()},i.prototype._dblClick=function(n){var i=this._g,u=i.hitTest(n),s=i.selection,f=u.range,r,e,o;if(!n.defaultPrevented){if(u.edgeRight&&i.allowResizing&1){if(u.cellType==2){for(n.ctrlKey&&s.containsColumn(u.col)&&(f=s),e=f.leftCol;e<=f.rightCol;e++)if(i.columns[e].allowResizing&&(r=new t.CellRangeEventArgs(i.cells,new t.CellRange(-1,e)),i.onAutoSizingColumn(r)&&i.onResizingColumn(r))){i.autoSizeColumn(e);i.onResizedColumn(r);i.onAutoSizedColumn(r)}}else if(u.cellType==4&&i.topLeftCells.columns[u.col].allowResizing&&(r=new t.CellRangeEventArgs(i.topLeftCells,new t.CellRange(-1,u.col)),i.onAutoSizingColumn(r)&&i.onResizingColumn(r))){i.autoSizeColumn(u.col,!0);i.onAutoSizedColumn(r);i.onResizedColumn(r)}return}if(u.edgeBottom&&i.allowResizing&2)if(u.cellType==3){for(n.ctrlKey&&s.containsRow(u.row)&&(f=s),o=f.topRow;o<=f.bottomRow;o++)if(i.rows[o].allowResizing&&(r=new t.CellRangeEventArgs(i.cells,new t.CellRange(o,-1)),i.onAutoSizingRow(r)&&i.onResizingRow(r))){i.autoSizeRow(o);i.onResizedRow(r);i.onAutoSizedRow(r)}}else if(u.cellType==4&&i.topLeftCells.rows[u.row].allowResizing&&(r=new t.CellRangeEventArgs(i.topLeftCells,new t.CellRange(u.row,-1)),i.onAutoSizingRow(r)&&i.onResizingRow(r))){i.autoSizeRow(u.row,!0);i.onResizedRow(r);i.onAutoSizedRow(r)}}},i.prototype._hover=function(n){if(this._htDown==null){var r=this._g,i=r.hitTest(n),u=i.panel,f="default";this._szRowCol=null;(i.cellType==2||i.cellType==4)&&r.allowResizing&1&&i.edgeRight&&u.columns[i.col].allowResizing&&(this._szRowCol=u.columns[i.col]);(i.cellType==3||i.cellType==4)&&r.allowResizing&2&&i.edgeBottom&&u.rows[i.row].allowResizing&&(this._szRowCol=u.rows[i.row]);this._szRowCol instanceof t.Column?f="col-resize":this._szRowCol instanceof t.Row&&(f="row-resize");this._szStart=this._szRowCol?this._szRowCol.renderSize:0;r.hostElement.style.cursor=f}},i.prototype._mouseSelect=function(n,i){var f,r,u;this._htDown&&this._htDown.panel&&this._g.selectionMode!=0&&(f=this._g,r=new t.HitTestInfo(this._htDown.panel,n),this._handleSelection(r,i),"documentMode"in document||(r=new t.HitTestInfo(f,n),r.cellType!=1&&r.cellType!=3&&(u=this,setTimeout(function(){u._mouseSelect(u._eMouse,i)},200))))},i.prototype._handleResizing=function(n){var i;if(n.preventDefault(),this._szRowCol instanceof t.Column&&(i=Math.max(1,this._szStart+(n.pageX-this._htDown.point.x)*(this._g._rtl?-1:1)),this._szRowCol.renderSize!=i)){this._szArgs==null&&(this._szArgs=new t.CellRangeEventArgs(this._htDown.panel,new t.CellRange(-1,this._szRowCol.index)));this._g.onResizingColumn(this._szArgs);this._g.deferResizing?this._showResizeMarker(i):this._szRowCol.width=Math.round(i)}if(this._szRowCol instanceof t.Row&&(i=Math.max(1,this._szStart+(n.pageY-this._htDown.point.y)),this._szRowCol.renderSize!=i)){this._szArgs==null&&(this._szArgs=new t.CellRangeEventArgs(this._htDown.panel,new t.CellRange(this._szRowCol.index,-1)));this._g.onResizingRow(this._szArgs);this._g.deferResizing?this._showResizeMarker(i):this._szRowCol.height=Math.round(i)}},i.prototype._dragStart=function(n){var r=this._g,i=this._htDown,u,f;i&&(this._dragSource=null,this._szRowCol||(u=new t.CellRangeEventArgs(r.cells,i.range),i.cellType==2&&r.allowDragging&1&&i.col>-1&&r.columns[i.col].allowDragging?r.onDraggingColumn(u)&&(this._dragSource=n.target):i.cellType==3&&r.allowDragging&2&&i.row>-1&&r.rows[i.row].allowDragging&&(f=r.rows[i.row],f instanceof t.GroupRow||f instanceof t._NewRowTemplate||r.onDraggingRow(u)&&(this._dragSource=n.target))),this._dragSource&&n.dataTransfer?(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text",""),this._dragSource.style.opacity=.5,n.stopPropagation()):n.preventDefault())},i.prototype._dragEnd=function(){this.resetMouseState()},i.prototype._dragOver=function(n){var i=this._g,t=i.hitTest(n),r=!1;this._htDown&&t.cellType==this._htDown.cellType&&(t.cellType==2?r=i.columns.canMoveElement(this._htDown.col,t.col):t.cellType==3&&(r=i.rows.canMoveElement(this._htDown.row,t.row)));r?(n.dataTransfer.dropEffect="move",n.preventDefault(),this._showDragMarker(t)):this._showDragMarker(null)},i.prototype._drop=function(n){var i=this._g,r=i.hitTest(n),f=new t.CellRangeEventArgs(i.cells,r.range),u;if(this._htDown&&r.cellType==this._htDown.cellType)if(u=i.selection,r.cellType==2){i.columns.moveElement(this._htDown.col,r.col);i.select(u.row,r.col);i.onDraggedColumn(f)}else if(r.cellType==3){i.rows.moveElement(this._htDown.row,r.row);i.select(r.row,u.col);i.onDraggedRow(f)}this.resetMouseState()},i.prototype._showResizeMarker=function(i){var f=this._g,u=this._dvMarker,r;u.parentElement||f.cells.hostElement.appendChild(u);this._szRowCol instanceof t.Column?(r={left:this._szRowCol.pos+i,top:0,right:"",bottom:0,width:2,height:""},f._rtl&&(r.left=u.parentElement.clientWidth-r.left-r.width)):r={left:0,top:this._szRowCol.pos+i,right:0,bottom:"",width:"",height:2};n.setCss(u,r)},i.prototype._showDragMarker=function(t){var u=this._g,r=this._dvMarker,i,f,e;if(!t){r.parentElement&&r.parentElement.removeChild(r);this._rngTarget=null;return}if(!t.range.equals(this._rngTarget)){this._rngTarget=t.range;r.parentElement||t.panel.hostElement.appendChild(r);i={left:0,top:0,width:6,height:6};switch(t.cellType){case 2:i.height=t.panel.height;f=u.columns[t.col];i.left=f.pos-i.width/2;t.col>this._htDown.col&&(i.left+=f.renderWidth);u._rtl&&(i.left=r.parentElement.clientWidth-i.left-i.width);break;case 3:i.width=t.panel.width;e=u.rows[t.row];i.top=e.pos-i.height/2;t.row>this._htDown.row&&(i.top+=e.renderHeight)}n.setCss(r,i)}},i.prototype._finishResizing=function(n){var i=this._g,o=i.selection,h=this._eMouse.ctrlKey,r=this._szArgs,u,s,f,e;if(r&&r.row>-1){u=r.row;s=Math.max(1,this._szStart+(n.pageY-this._htDown.point.y));i.rows[u].height=Math.round(s);i.onResizedRow(r);if(h&&this._htDown.cellType!=4&&o.containsRow(u))for(f=o.topRow;f<=o.bottomRow;f++)if(i.rows[f].allowResizing&&f!=u){r=new t.CellRangeEventArgs(i.cells,new t.CellRange(f,-1));i.onResizingRow(r);if(!r.cancel){i.rows[f].size=i.rows[u].size;i.onResizedRow(r)}}}if(r&&r.col>-1){u=r.col;s=Math.max(1,this._szStart+(n.pageX-this._htDown.point.x)*(this._g._rtl?-1:1));i.columns[u].width=Math.round(s);i.onResizedColumn(r);if(h&&this._htDown.cellType!=4&&o.containsColumn(u))for(e=o.leftCol;e<=o.rightCol;e++)if(i.columns[e].allowResizing&&e!=u){r=new t.CellRangeEventArgs(i.cells,new t.CellRange(-1,e));i.onResizingColumn(r);if(!r.cancel){i.columns[e].size=i.columns[u].size;i.onResizedColumn(r)}}}},i.prototype._startListBoxSelection=function(n){var i=this._g.rows,t;for(this._lbSelState=!i[n].isSelected,this._lbSelRows={},t=0;t<i.length;t++)i[t].isSelected&&(this._lbSelRows[t]=!0)},i.prototype._handleSelection=function(n,i){var e=this,u=this._g,s=u.rows,o=u.selection,f=new t.CellRange(n.row,n.col),h,c,r;if(n.row>-1&&n.col>-1)if(this._lbSelRows!=null){for(f=new t.CellRange(n.row,n.col,e._htDown.row,e._htDown.col),r=0;r<s.length;r++)if(h=f.containsRow(r)?e._lbSelState:e._lbSelRows[r]!=null,h!=s[r].isSelected&&(c=new t.CellRangeEventArgs(u.cells,new t.CellRange(r,o.col,r,o.col2)),u.onSelectionChanging(c))){s[r].isSelected=h;u.onSelectionChanged(c)}u.scrollIntoView(n.row,n.col)}else n.cellType==3&&(f.col=0,f.col2=u.columns.length-1),i&&(f.row2=o.row2,f.col2=o.col2),u.select(f)},i.prototype._handleSort=function(i){var r=this._g,o=r.collectionView,u=r.hitTest(i),s,c,h,e;if(this._htDown&&u.cellType==this._htDown.cellType&&u.col==this._htDown.col&&u.cellType==2&&!u.edgeRight&&u.col>-1&&o&&o.canSort&&r.allowSorting&&(s=r.getMergedRange(r.columnHeaders,u.row,u.col),c=s?s.bottomRow:u.row,c==r._getSortRowIndex())){var f=r.columns[u.col],l=f.currentSort,a=l!="+";if(f.allowSorting&&f.binding){if(!l&&i.ctrlKey)return;if(h=new t.CellRangeEventArgs(r.columnHeaders,new t.CellRange(-1,u.col)),r.onSortingColumn(h)){e=o.sortDescriptions;i.ctrlKey?e.clear():e.splice(0,e.length,new n.collections.SortDescription(f._getBindingSort(),a));r.onSortedColumn(h)}}}},i}();t._MouseHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(i){this._fullEdit=!1;this._list=null;this._g=i;var r=this;this._evtInput=document.createEvent("HTMLEvents");this._evtInput.initEvent("input",!0,!1);i.selectionChanging.addHandler(function(n,t){r.finishEditing();t.row!=i.selection.row&&r._commitRowEdits()});i.addEventListener(i.hostElement,"blur",this._blur.bind(this),!0);i.addEventListener(i.hostElement,"mousedown",function(u){var o=i.selection,e=i.hitTest(u),f,s;if(r._htDown=null,e.cellType!=1&&e.cellType!=0)r._lbx&&n.contains(r._lbx.hostElement,u.target)||r._commitRowEdits();else if(e.cellType!=0){if(f=n.tryCast(u.target,HTMLInputElement),f&&f.type=="checkbox"&&n.hasClass(f.parentElement,"wj-cell")&&(f!=r.activeEditor?(u.preventDefault(),u.stopPropagation(),r.startEditing(!1,e.row,e.col),setTimeout(function(){f=r.activeEditor;f&&f.type=="checkbox"&&(f.checked=!f.checked,r.finishEditing())})):r.finishEditing()),s=document.elementFromPoint(u.clientX,u.clientY),n.closest(s,"["+t.CellFactory._WJA_DROPDOWN+"]")){r._toggleDropDown(e);r._htDown=null;u.preventDefault();return}f==null&&e.row==o.row&&e.col==o.col&&(r._htDown=e)}},!0);i.addEventListener(i.hostElement,"click",function(n){if(r._htDown&&!r.activeEditor){var t=i.hitTest(n);t.range.equals(r._htDown.range)&&r.startEditing(!0,t.row,t.col)}})}return i.prototype.startEditing=function(i,r,u,f){var e,s,h,c,l,a,o;if((typeof i=="undefined"&&(i=!0),e=this._g,r=n.asNumber(r,!0,!0),u=n.asNumber(u,!0,!0),r==null&&(r=e.selection.row),u==null&&(u=e.selection.col),f==null&&(f=!0),!this._allowEditing(r,u))||(s=e.getMergedRange(e.cells,r,u),s||(s=new t.CellRange(r,u)),h=e.rows[r].dataItem,e.select(s,!0),!e.rows[r]||h!=e.rows[r].dataItem))return!1;if(s.equals(this._rng))return!0;if(c=new t.CellRangeEventArgs(e.cells,s),!e.onBeginningEdit(c))return!1;if(l=n.tryCast(e.collectionView,"IEditableCollectionView"),l&&(h=e.rows[r].dataItem,l.editItem(h)),this._fullEdit=i,this._rng=s,this._list=null,a=e.columns[u].dataMap,a&&(this._list=a.getDisplayValues()),e.refresh(!1),o=this._edt,o){o.type=="checkbox"?this._fullEdit=!1:f&&n.setSelectionRange(o,0,o.value.length);e.onPrepareCellForEdit(c);o=this._edt;o&&f&&o.focus()}return!0},i.prototype.finishEditing=function(n){var r,s,f,e;if(typeof n=="undefined"&&(n=!1),r=this._edt,!r)return this._removeListBox(),!0;var i=this._g,u=this._rng,o=new t.CellRangeEventArgs(i.cells,u),h=this._g.containsFocus();o.cancel=n;i.onCellEditEnding(o);if(!o.cancel)for(s=r.type=="checkbox"?r.checked:r.value,f=u.topRow;f<=u.bottomRow&&f<i.rows.length;f++)for(e=u.leftCol;e<=u.rightCol&&e<i.columns.length;e++)i.cells.setCellData(f,e,s,!0);this._edt=null;this._rng=null;this._list=null;this._removeListBox();i.refresh(!1);h&&!i.containsFocus()&&i.focus();i.onCellEditEnded(o);return!0},Object.defineProperty(i.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0}),i.prototype._allowEditing=function(n,t){var i=this._g;return i.isReadOnly||i.selectionMode==0?!1:n<0||n>=i.rows.length||i.rows[n].isReadOnly||!i.rows[n].isVisible?!1:t<0||t>=i.columns.length||i.columns[t].isReadOnly||!i.columns[t].isVisible?!1:!0},i.prototype._commitRowEdits=function(){var i,r,u;if(this.finishEditing(),i=this._g,r=n.tryCast(i.collectionView,"IEditableCollectionView"),r&&r.currentEditItem){u=new t.CellRangeEventArgs(i.cells,i.selection);i.onRowEditEnding(u);r.commitEdit();i.onRowEditEnded(u)}},i.prototype._blur=function(){var n=this;setTimeout(function(){if(!n._g.containsFocus()){var t=document.activeElement;t&&getComputedStyle(t).position=="fixed"||n._commitRowEdits()}},200)},i.prototype._keydown=function(n){switch(n.keyCode){case 113:return this._fullEdit=!this._fullEdit,n.preventDefault(),!0;case 32:var t=this._edt;return t&&t.type=="checkbox"&&(t.checked=!t.checked,this.finishEditing(),n.preventDefault()),!0;case 13:case 9:return this.finishEditing(),!1;case 27:return this.finishEditing(!0),!0;case 38:case 40:case 37:case 39:case 33:case 34:case 36:case 35:if(!this._fullEdit)return this.finishEditing(),!1}return!0},i.prototype._keypress=function(t){var i=this._edt,f,r,u;if(i&&i.type!="checkbox"&&t.target==i&&this._list&&this._list.length>0&&t.charCode>=32)for(f=i.selectionStart,r=i.value,r=r.substr(0,f),t.target==i&&(f++,r+=String.fromCharCode(t.charCode)),r=r.toLowerCase(),u=0;u<this._list.length;u++)if(this._list[u].toLowerCase().indexOf(r)==0){i.value=this._list[u];n.setSelectionRange(i,f,this._list[u].length);i.dispatchEvent(this._evtInput);t.preventDefault();break}},i.prototype._toggleDropDown=function(t){var r=this,i=this._g,u;if(this._lbx&&(this._removeListBox(),i.selection.contains(t.range))){i.activeEditor?i.activeEditor.focus():i.containsFocus()||i.focus();return}(u=i.isTouching,n.input&&this.startEditing(!0,t.row,t.col,!u))&&(this._lbx=this._createListBox(),this._lbx.showSelection(),u&&this._lbx.focus(),this._lbx.selectedIndexChanged.addHandler(function(){var n=i.activeEditor;n&&(n.value=r._lbx.selectedValue,n.dispatchEvent(r._evtInput),r.finishEditing());r._removeListBox()}))},i.prototype._createListBox=function(){var i=this._g,r=this._rng,e=i.rows[r.row],o=i.columns[r.col],u=document.createElement("div"),t=new n.input.ListBox(u),f;return n.addClass(u,"wj-dropdown-panel"),t.maxHeight=e.renderHeight*4,t.itemsSource=o.dataMap.getDisplayValues(),t.selectedValue=i.activeEditor?i.activeEditor.value:i.getCellData(r.row,r.col,!0),f=this,t.addEventListener(t.hostElement,"click",function(){f._removeListBox()}),t.addEventListener(t.hostElement,"blur",this._blur.bind(this),!0),n.showPopup(u,i.getCellBoundingRect(r.row,r.col)),t},i.prototype._removeListBox=function(){this._lbx&&(n.hidePopup(this._lbx.hostElement,!0),this._lbx.removeEventListener(),this._lbx=null)},i}();t._EditHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";var r=function(){function t(n){this._nrt=new i;this._g=n;n.beginningEdit.addHandler(this._beginningEdit,this);n.rowEditEnded.addHandler(this._rowEditEnded,this);n.loadedRows.addHandler(this.updateNewRowTemplate,this)}return t.prototype.updateNewRowTemplate=function(){var u=n.tryCast(this._g.collectionView,"IEditableCollectionView"),r=this._g,t=r.rows,f=u&&u.canAddNew&&r.allowAddNew&&!r.isReadOnly,i=t.indexOf(this._nrt);!f&&i>-1?t.removeAt(i):f&&(i<0?t.push(this._nrt):i!=t.length-1&&(t.removeAt(i),t.push(this._nrt)),this._nrt&&this._nrt._setFlag(128,!1))},t.prototype._beginningEdit=function(t,r){var f,u,e;if(!r.cancel&&(f=this._g.rows[r.row],n.tryCast(f,i)&&(u=n.tryCast(this._g.collectionView,"IEditableCollectionView"),u&&u.canAddNew))){e=u.isAddingNew?u.currentAddItem:u.addNew();u.moveCurrentTo(e);this.updateNewRowTemplate();this._g.refresh(!0);this._g.onRowAdded(r);r.cancel&&u.cancelNew()}},t.prototype._rowEditEnded=function(){var t=n.tryCast(this._g.collectionView,"IEditableCollectionView");t&&t.isAddingNew&&t.commitNew()},t}(),i;t._AddNewHandler=r;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t.Row);t._NewRowTemplate=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}))